{"version":3,"sources":["webpack:///./src/components/uploadImg/index.vue?c21b","webpack:///./src/components/uploadImg/index.vue?9d4e","webpack:///src/components/uploadImg/index.vue","webpack:///./src/components/uploadImg/index.vue?bd5f","webpack:///./src/components/uploadImg/index.vue","webpack:///./node_modules/vant/es/image-preview/style/index.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_l","item","index","key","disabled","_e","on","$event","doDelete","attrs","imageFit","imgPreview","innerImages","length","maxCount","showActions","_v","_s","cameraDes","actions","onSelect","model","value","callback","$$v","expression","beforeRead","maxSize","multiple","uploadImg","onOverSize","imagesChange","staticRenderFns","prop","event","props","type","Boolean","default","images","Array","Number","String","oversize","Function","enableImagePicker","compressConfig","Object","data","isHaierApp","$util","loading","methods","map","startPosition","imagePicker","instance","initDeviceReady","then","console","log","upImageModule","max","typeMode","singleChoice","showCamera","tips","cropImage","showOriginalBtn","allFileSizeByteLimit","res","retData","list","paths","fileToBase64","result","file","size","content","base64","oversizeFlag","err","openCamera","base64Data","split","match","splice","forEach","test","img","src","onload","canvas","width","height","context","drawImage","dataURLtoBlob","arr","dataurl","mime","bstr","atob","n","u8arr","Uint8Array","charCodeAt","Blob","$emit","callbackName","some","$toast","watch","handler","nv","push","immediate","component"],"mappings":"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","file":"js/chunk-e5c4f6f4.c7f7f32f.js","sourcesContent":["export * from \"-!../../../node_modules/@sg/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=1e6f34fa&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"upload-pic\"},[(_vm.isHaierApp)?_c('div',{staticClass:\"photo-preview\"},[_vm._l((_vm.innerImages),function(item,index){return _c('div',{key:index,staticClass:\"photo-item\"},[(!_vm.disabled)?_c('div',{staticClass:\"delete-icon\",on:{\"click\":function($event){return _vm.doDelete(index)}}}):_vm._e(),_c('van-image',{attrs:{\"src\":(\"\" + (item.content)),\"fit\":_vm.imageFit},on:{\"click\":function($event){return _vm.imgPreview(index)}}})],1)}),(_vm.innerImages.length < _vm.maxCount && !_vm.disabled)?_c('div',{staticClass:\"photo-upload\",attrs:{\"duration\":0},on:{\"click\":function($event){_vm.showActions = true}}},[_c('img',{staticClass:\"camera\",attrs:{\"src\":\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAA3klEQVRYR+3ZsQ3CMBAF0PsNi8AgKZmAFZwVoCE0sIJvBSagzB7AIjSHIoVUIDk5GxH0U6WIv76eFeuUQDJdqroUkUsftw4h3HNEI0dIlxFj3AI4dvdmtqvr+pQjO1tBVd2LSNOXakIIBxYcI0DBMVrvnqUgBScK8BycCDcsoyAFUwV4UKdKfXqumGA3CZvZBsDCU9LMKgBVP7C2AFpn3gPAGap6FZGVJ6zg2tssCv72FufanmIvCQs6BTgsOAGFghRMFeA5mCr19XHLW+y1nlvslaTg3wvO4SN6kd8QT38D5VFlhkFpAAAAAElFTkSuQmCC\"}}),_c('div',{staticClass:\"camera-des\"},[_vm._v(_vm._s(_vm.cameraDes))])]):_vm._e(),_c('van-action-sheet',{attrs:{\"actions\":_vm.actions},on:{\"select\":_vm.onSelect},model:{value:(_vm.showActions),callback:function ($$v) {_vm.showActions=$$v},expression:\"showActions\"}})],2):_c('div',{staticClass:\"photo-show\"},[_c('van-uploader',{attrs:{\"before-read\":_vm.beforeRead,\"accept\":\"image/*\",\"max-size\":_vm.maxSize,\"deletable\":!_vm.disabled,\"multiple\":_vm.multiple,\"image-fit\":_vm.imageFit,\"after-read\":_vm.uploadImg,\"max-count\":_vm.maxCount,\"show-upload\":!_vm.disabled},on:{\"oversize\":_vm.onOverSize,\"delete\":_vm.imagesChange},model:{value:(_vm.innerImages),callback:function ($$v) {_vm.innerImages=$$v},expression:\"innerImages\"}},[(!_vm.disabled)?[_c('img',{staticClass:\"camera\",attrs:{\"src\":\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAA3klEQVRYR+3ZsQ3CMBAF0PsNi8AgKZmAFZwVoCE0sIJvBSagzB7AIjSHIoVUIDk5GxH0U6WIv76eFeuUQDJdqroUkUsftw4h3HNEI0dIlxFj3AI4dvdmtqvr+pQjO1tBVd2LSNOXakIIBxYcI0DBMVrvnqUgBScK8BycCDcsoyAFUwV4UKdKfXqumGA3CZvZBsDCU9LMKgBVP7C2AFpn3gPAGap6FZGVJ6zg2tssCv72FufanmIvCQs6BTgsOAGFghRMFeA5mCr19XHLW+y1nlvslaTg3wvO4SN6kd8QT38D5VFlhkFpAAAAAElFTkSuQmCC\"}}),_c('div',{staticClass:\"camera-des\"},[_vm._v(_vm._s(_vm.cameraDes))])]:_vm._e()],2),(_vm.loading)?_c('van-loading',{attrs:{\"type\":\"spinner\",\"color\":\"#1989fa\"}}):_vm._e()],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"upload-pic\">\n    <div class=\"photo-preview\" v-if=\"isHaierApp\">\n      <div class=\"photo-item\" v-for=\"(item, index) in innerImages\" :key=\"index\">\n        <div class=\"delete-icon\" @click=\"doDelete(index)\" v-if=\"!disabled\"></div>\n        <van-image\n          :src=\"`${item.content}`\"\n          @click=\"imgPreview(index)\"\n          :fit=\"imageFit\"\n        ></van-image>\n      </div>\n      <div class=\"photo-upload\" @click=\"showActions = true\" :duration=\"0\" v-if=\"innerImages.length < maxCount && !disabled\">\n        <img class=\"camera\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAA3klEQVRYR+3ZsQ3CMBAF0PsNi8AgKZmAFZwVoCE0sIJvBSagzB7AIjSHIoVUIDk5GxH0U6WIv76eFeuUQDJdqroUkUsftw4h3HNEI0dIlxFj3AI4dvdmtqvr+pQjO1tBVd2LSNOXakIIBxYcI0DBMVrvnqUgBScK8BycCDcsoyAFUwV4UKdKfXqumGA3CZvZBsDCU9LMKgBVP7C2AFpn3gPAGap6FZGVJ6zg2tssCv72FufanmIvCQs6BTgsOAGFghRMFeA5mCr19XHLW+y1nlvslaTg3wvO4SN6kd8QT38D5VFlhkFpAAAAAElFTkSuQmCC\"/>\n        <div class=\"camera-des\">{{cameraDes}}</div>\n      </div>\n      <van-action-sheet v-model=\"showActions\" :actions=\"actions\" @select=\"onSelect\" />\n    </div>\n\n    <div class=\"photo-show\" v-else>\n      <van-uploader\n        :before-read=\"beforeRead\"\n        accept=\"image/*\"\n        :max-size=\"maxSize\"\n        v-model=\"innerImages\"\n        @oversize=\"onOverSize\"\n        :deletable=\"!disabled\"\n        :multiple=\"multiple\"\n        :image-fit=\"imageFit\"\n        :after-read=\"uploadImg\"\n        :max-count=\"maxCount\"\n        @delete=\"imagesChange\"\n        :show-upload=\"!disabled\"\n      >\n        <template v-if=\"!disabled\">\n          <img class=\"camera\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAA3klEQVRYR+3ZsQ3CMBAF0PsNi8AgKZmAFZwVoCE0sIJvBSagzB7AIjSHIoVUIDk5GxH0U6WIv76eFeuUQDJdqroUkUsftw4h3HNEI0dIlxFj3AI4dvdmtqvr+pQjO1tBVd2LSNOXakIIBxYcI0DBMVrvnqUgBScK8BycCDcsoyAFUwV4UKdKfXqumGA3CZvZBsDCU9LMKgBVP7C2AFpn3gPAGap6FZGVJ6zg2tssCv72FufanmIvCQs6BTgsOAGFghRMFeA5mCr19XHLW+y1nlvslaTg3wvO4SN6kd8QT38D5VFlhkFpAAAAAElFTkSuQmCC\"/>\n          <div class=\"camera-des\">{{cameraDes}}</div>\n        </template>\n        <!-- <img class=\"camera\" :src=\"`${$cdnImageUrl}/pc/camera.png`\"/> -->\n      </van-uploader>\n      <van-loading type=\"spinner\" color=\"#1989fa\" v-if=\"loading\"/>\n    </div>\n  </div>\n</template>\n\n<script>\nimport UplusApi from '@uplus/uplus-api';\nimport { ImagePreview, Toast } from 'vant';\n\nconst instance = new UplusApi()\nexport default {\n  model: {\n    prop: 'images',\n    event: 'onImagesChange'\n  },\n  props: {\n    disabled: {\n      type: Boolean,\n      default: false\n    },\n    images: {\n      type: Array,\n      default: () => []\n    },\n    multiple: {\n      type: Boolean,\n      default: false\n    },\n    maxSize: {\n      type: Number,\n      default: 5 * 1024 * 1024\n    },\n    imageFit: {\n      type: String,\n      default: 'cover'\n    },\n    oversize: {\n      type: Function,\n      default: () => {\n        Toast('图片不可大于5M')\n      }\n    },\n    cameraDes: {\n      type: String,\n      default: '添加图片'\n    },\n    maxCount: {\n      type: Number,\n      default: 6\n    },\n    enableImagePicker: {\n      type: Boolean,\n      default: true\n    },\n    compressConfig: {\n      type: Object,\n      default: () => ({\n        size: { width: 400, height: 300 },\n        quality: 0.92\n      })\n    }\n  },\n  data() {\n    return {\n      isHaierApp: this.$util.isHaierApp(),\n      innerImages: [],\n      loading: false,\n\n      showActions: false,\n      actions: [{ name: '相机', callbackName: 'openCamera' }]\n    }\n  },\n  methods: {\n    /**\n     * 智家app预览图片\n     */\n    imgPreview(index) {\n      ImagePreview({\n        images: this.innerImages.map(v => v.content),\n        startPosition: index,\n      })\n    },\n    /**\n     * 打开智家相册\n     */\n    imagePicker() {\n      this.loading = true\n      instance.initDeviceReady().then(() => {\n        console.log('sdk upload ====>')\n        instance.upImageModule.imagePicker({\n          max: this.maxCount - this.innerImages.length,\n          typeMode: 0,\n          singleChoice: false,\n          showCamera: false,\n          tips: '请选择照片',\n          cropImage: false,\n          showOriginalBtn: true,\n          allFileSizeByteLimit: this.maxSize\n        }).then((res) => {\n          console.log('success:path', res);\n          if (res.retData.list.length) {\n            let paths = res.retData.list.map(item => item.path);\n            console.log('file paths', paths)\n            instance.upImageModule.fileToBase64({ filePaths: paths }).then((result) => {\n              console.log('result base64 arr', result.retData);\n              let oversizeFlag = false\n              const imagesArr = result.retData.map(img => {\n                const base64 = `data:image/jpeg;base64,${img.base64Data}`\n                const blob = this.dataURLtoBlob(base64)\n                let file = new window.File([blob], `${new Date()}.jpeg`, { type: 'image/jpeg' })\n                if (file.size > this.maxSize) oversizeFlag = true\n                return {\n                  content: base64,\n                  file\n                }\n              })\n              if (oversizeFlag) {\n                this.onOverSize()\n              } else {\n                this.innerImages = [...this.innerImages, ...imagesArr]\n                this.uploadImg()\n              }\n              console.log(this.innerImages, 'this.innerImages')\n            }, (err) => {\n              console.log('base64 err', err);\n              this.loading = false\n            })\n          } else {\n            console.log('imagePicker err')\n            this.loading = false\n          }\n        }).catch((err) => {\n          console.log('sdk imagePicker', err)\n          this.loading = false\n        });\n      })\n    },\n    /**\n     * 智家调取相机拍照\n     */\n    openCamera() {\n      this.loading = true\n      instance.initDeviceReady().then(() => {\n        instance.upImageModule.openCamera({ destinationType: 2 }).then((result) => {\n          console.log('canmer result', result);\n          if (result.retData.base64Data) {\n            var type = result.retData.base64Data.split(',')[0].match(/:(.*?);/)[1];\n            const blob = this.dataURLtoBlob(result.retData.base64Data)\n            let file = new window.File([blob], `${new Date()}.${type.split('/')[1]}`, { type })\n            if (file.size <= this.maxSize) {\n              this.innerImages.push({\n                content: result.retData.base64Data,\n                file\n              })\n              this.uploadImg()\n            } else {\n              this.onOverSize()\n            }\n          }\n        }, (err) => {\n          this.loading = false\n          console.log(err)\n        })\n      })\n    },\n\n    doDelete(index) {\n      this.innerImages.splice(index, 1);\n      this.imagesChange()\n    },\n\n    /**\n     * @description  传本地完成后\n    */\n    uploadImg() {\n      this.innerImages.forEach(item => {\n        console.log('前', item.file)\n        if (/\\/(?:jpeg|png)/i.test(item.file.type) && item.file.size > 1000000) {\n        // 创建Canvas对象(画布)\n          let canvas = document.createElement('canvas')\n          // 获取对应的CanvasRenderingContext2D对象(画笔)\n          let context = canvas.getContext('2d')\n          // 创建新的图片对象\n          let img = new Image()\n          // 指定图片的DataURL(图片的base64编码数据)\n          img.src = item.content\n          // 监听浏览器加载图片完成，然后进行进行绘制\n          img.onload = () => {\n          // 指定canvas画布大小，该大小为最后生成图片的大小\n            canvas.width = this.compressConfig.size.width\n            canvas.height = this.compressConfig.size.height\n            /* drawImage画布绘制的方法。(0,0)表示以Canvas画布左上角为起点，400，300是将图片按给定的像素进行缩小。\n        如果不指定缩小的像素图片将以图片原始大小进行绘制，图片像素如果大于画布将会从左上角开始按画布大小部分绘制图片，最后的图片就是张局部图。 */\n            context.drawImage(img, 0, 0, this.compressConfig.size.width, this.compressConfig.size.height)\n            // 将绘制完成的图片重新转化为base64编码，file.file.type为图片类型，0.92为默认压缩质量\n            let blob = this.dataURLtoBlob(canvas.toDataURL(item.file.type, this.compressConfig.quality));\n            // let file = this.blobToFile(blob);\n            // blob转file\n            let file = new window.File([blob], item.file.name, { type: item.file.type })\n            item.file = file\n            console.log('item.file', item.file)\n          }\n        }\n      })\n      this.imagesChange()\n    },\n    /**\n     * @description  将base64转换为blob\n    */\n    dataURLtoBlob: function(dataurl) {\n      var arr = dataurl.split(',');\n      var mime = arr[0].match(/:(.*?);/)[1];\n      var bstr = atob(arr[1]);\n      var n = bstr.length;\n      var u8arr = new Uint8Array(n);\n      while (n--) {\n        u8arr[n] = bstr.charCodeAt(n);\n      }\n      return new Blob([u8arr], { type: mime });\n    },\n    /**\n     * @description  图片数组变更\n    */\n    imagesChange() {\n      this.loading = false\n      this.$emit('onImagesChange', this.innerImages)\n    },\n\n    onSelect(item) {\n      this.showActions = false\n      this[item.callbackName]()\n    },\n\n    onOverSize() {\n      this.loading = false\n      this.oversize()\n    },\n\n    beforeRead(file) {\n      const arr = Array.isArray(file) ? file : [file]\n      if (arr.some(f => !f.type.includes('image'))) {\n        this.$toast('请上传图片文件')\n        return false\n      }\n      this.loading = true\n      return true\n    }\n  },\n  watch: {\n    // images: {\n    //   handler(nv) {\n    //     if (nv) this.innerImages = nv\n    //   },\n    //   immediate: true\n    // },\n    enableImagePicker: {\n      handler(nv) {\n        if (nv) {\n          if (this.actions.length <= 1) this.actions.push({ name: '相册', callbackName: 'imagePicker' })\n        } else {\n          this.actions.splice(1)\n        }\n      },\n      immediate: true\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.upload-pic {\n  .photo-upload{\n    margin-left: 0.24rem;\n    margin-bottom: .24rem;\n    display: inline-flex;\n    vertical-align: middle;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    width: 2.04rem;\n    height: 2.04rem;\n    border: 1px dashed #e5e5e5;\n  }\n\n  .photo-preview{\n    width: 110%;\n  }\n\n  .photo-item{\n    margin-left: 0.24rem;\n    margin-bottom: .24rem;\n    display: inline-flex;\n    position: relative;\n    width: 2.04rem;\n    height: 2.04rem;\n    vertical-align: middle;\n    .van-image {\n      width: 100%;\n      height: 100%;\n    }\n  }\n\n  .delete-icon{\n    z-index: 1;\n    display: block;\n    position: absolute;\n    top: -4px;\n    right: -4px;\n    width: 19px;\n    height: 19px;\n    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAABY0lEQVQ4T2NkoCJgxGNWNAMDgx0W+UMMDAxLsenDZpg7AwNDEBEOXsfAwLATWR26YcUMDAxqRBgEU3KLgYGhF8ZBNoxYF6HbBXchsmEzYarU1dW5/Pz8xLu7u++j6+zs7NTq6uq6/fbt299IcukgNswwlMAuLS1V7Orqcu3r6ztaXFx8FaZpzZo1FsHBwXqBgYEbNmzY8ArJMHCkwAyDuwqmoLe3V7uoqMgaZiDMoJycnJ1Tp059iCVc03EaBlIMM/DKlStPdXR0pPEYBFKO3zCQisuXL3uDDNq5c+d1Dw+Pw3hiGr9hMK+BDHJ3d9fs7e09UlJScg2HgbgNQw+jnp4ereLiYhs8BsINQ4nN7u5urZKSEhv0MIIZmJqaum3OnDlPcMUmSBweo8LCwqy2traCaNEP1puSkiKzZMmSZz9+/PiHK52BxKmaA0AGUi1vwlxNrAsJlhrIsU6V8oyEEghVKQDHOJMUlL41vgAAAABJRU5ErkJggg==) no-repeat center center;\n    background-size: cover;\n  }\n\n  .photo-show{\n    display: flex;\n    justify-content: flex-start;\n    flex-wrap: wrap;\n    margin-left: 0.24rem;\n    /* margin-top: 0.20rem; */\n    position: relative;\n  }\n  .photo-show ::v-deep .van-uploader__preview-delete{\n    background-size: 100%;\n    width: 19px;\n    height: 19px;\n    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAABY0lEQVQ4T2NkoCJgxGNWNAMDgx0W+UMMDAxLsenDZpg7AwNDEBEOXsfAwLATWR26YcUMDAxqRBgEU3KLgYGhF8ZBNoxYF6HbBXchsmEzYarU1dW5/Pz8xLu7u++j6+zs7NTq6uq6/fbt299IcukgNswwlMAuLS1V7Orqcu3r6ztaXFx8FaZpzZo1FsHBwXqBgYEbNmzY8ArJMHCkwAyDuwqmoLe3V7uoqMgaZiDMoJycnJ1Tp059iCVc03EaBlIMM/DKlStPdXR0pPEYBFKO3zCQisuXL3uDDNq5c+d1Dw+Pw3hiGr9hMK+BDHJ3d9fs7e09UlJScg2HgbgNQw+jnp4ereLiYhs8BsINQ4nN7u5urZKSEhv0MIIZmJqaum3OnDlPcMUmSBweo8LCwqy2traCaNEP1puSkiKzZMmSZz9+/PiHK52BxKmaA0AGUi1vwlxNrAsJlhrIsU6V8oyEEghVKQDHOJMUlL41vgAAAABJRU5ErkJggg==) no-repeat center center;\n    position: absolute;\n    top: -4px !important;\n    right: -4px !important;\n    .van-icon {\n      display: none;\n    }\n  }\n  .photo-some{\n    position: relative;\n    margin-right: 0.20rem;\n    margin-top: 0.22rem;\n  }\n  .delte-photo{\n    position: absolute;\n    right: 0;\n    top: 0;\n    width: 0.48rem;\n    height: 0.48rem;\n    z-index: 99;\n  }\n  .camera {\n    width: 0.4rem;\n    height: 0.4rem;\n  }\n  .camera-des{\n    font-size:0.24rem;\n    font-weight:400;\n    color:#999999;\n    margin-top: 0.16rem;\n  }\n  .up-photo{\n    width:1.40rem;\n    height:1.40rem;\n    border-radius:0.06rem;\n  }\n  .photo-graph{\n    width:1.40rem;\n    height:1.40rem;\n    border-radius:0.06rem;\n    border:0.02rem dashed #e5e5e5;\n    margin-top: 0.22rem;\n    display: flex;\n    justify-content: center;\n    align-content: center;\n    flex-wrap: wrap;\n  }\n  .photo-show ::v-deep .van-uploader__input-wrapper{\n    width:2.08rem;\n    height:2.08rem;\n    border-radius:0.06rem;\n    border:0.02rem dashed #e5e5e5;\n    margin-bottom: 0.24rem;\n    display: flex;\n    justify-content: center;\n    align-content: center;\n    flex-wrap: wrap;\n    flex-flow: column;\n    align-items: center;\n  }\n  .photo-show ::v-deep .van-uploader__preview-image{\n    width: 2.08rem;\n    height: 2.08rem;\n  }\n  .photo-show ::v-deep .van-uploader__preview-delete{\n    top: 0;\n    right: 0;\n  }\n  .photo-show ::v-deep .van-uploader__preview{\n    margin: 0 0.16rem 0.22rem 0;\n  }\n  .van-loading{\n    position: absolute;\n    left: 45%;\n    top: 0.5rem;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=1e6f34fa&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=1e6f34fa&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1e6f34fa\",\n  null\n  \n)\n\nexport default component.exports","import '../../style/base.css';\nimport '../../overlay/index.css';\nimport '../../info/index.css';\nimport '../../icon/index.css';\nimport '../../image/index.css';\nimport '../../popup/index.css';\nimport '../../loading/index.css';\nimport '../../swipe/index.css';\nimport '../../swipe-item/index.css';\nimport '../index.css';"],"sourceRoot":""}