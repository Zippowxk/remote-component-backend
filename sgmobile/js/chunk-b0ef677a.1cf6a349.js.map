{"version":3,"sources":["webpack:///./src/views/goods/customer-service/container.vue?f519","webpack:///src/views/goods/customer-service/container.vue","webpack:///./src/views/goods/customer-service/container.vue?8126","webpack:///./src/views/goods/customer-service/container.vue","webpack:///./src/views/goods/customer-service/container.vue?0a9e"],"names":["render","_vm","this","_h","$createElement","_c","_self","userAgent","_e","staticClass","style","showHeader","attrs","userId","urlHost","sceneId","accountId","sign","userName","encodedURL","fromPageUrl","sceneName","scenePhoto","fromPageTitle","phone","email","staticRenderFns","name","needUpAuth","fromPageTitlePrefix","traceLogOrigin","device","defaultAccountId","pageTitle","pId","pid","key","userAgentMap","components","Header","data","utils","created","$route","meta","title","query","mounted","$util","isAlipay","$toast","$store","dispatch","then","isLogin","initBase","methods","url","window","encodeURIComponent","isCanGetCustomer","res","initService","memberInfo","success","origin","frameDom","headerBaseHeight","height","console","log","err","Promise","storeCode","resolve","result","getMemberInfo","localStorage","getItem","traceLog","getBrowserInterfaceSize","pageWidth","innerWidth","pageHeight","innerHeight","document","compatMode","documentElement","clientWidth","clientHeight","body","component"],"mappings":"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","file":"js/chunk-b0ef677a.1cf6a349.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[(_vm.userAgent.showHeader)?_c('Header'):_vm._e(),_c('div',{staticClass:\"container\",style:({'padding-top': _vm.userAgent.showHeader?'0.92rem':'0'}),attrs:{\"id\":\"frameContainer\"}},[(!_vm.userId)?_c('div'):_c('iframe',{staticClass:\"activeiframe\",attrs:{\"src\":(_vm.urlHost + \"/#/zhijia?entranceId=jt&device=\" + (_vm.userAgent.device) + \"&sceneId=\" + _vm.sceneId + \"&pId=\" + (_vm.userAgent.pId) + \"&userId=\" + _vm.userId + \"&accountId=\" + _vm.accountId + \"&sign=\" + _vm.sign + \"&userName=\" + _vm.userName + \"&fromPageUrl=\" + (_vm.encodedURL(_vm.fromPageUrl)) + \"&sceneName=\" + _vm.sceneName + \"&scenePhoto=\" + (_vm.encodedURL(_vm.scenePhoto)) + \"&fromPageTitle=\" + _vm.fromPageTitle + \"&p=\" + _vm.phone + \"&e=\" + _vm.email + \"&\" + (_vm.userAgent.showHeader ? 'titleBar=hide' : '')),\"name\":\"ac\",\"frameborder\":\"0\",\"width\":\"100%\",\"scrolling\":\"auto\",\"id\":\"ActiveIframe\"}})])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n<div>\n  <Header v-if=\"userAgent.showHeader\"></Header>\n  <div class=\"container\"\n        :style=\"{'padding-top': userAgent.showHeader?'0.92rem':'0'}\"\n        id=\"frameContainer\">\n      <div v-if=\"!userId\"></div>\n      <iframe v-else :src=\"`${urlHost}/#/zhijia?entranceId=jt&device=${userAgent.device}&sceneId=${sceneId}&pId=${userAgent.pId}&userId=${userId}&accountId=${accountId}&sign=${sign}&userName=${userName}&fromPageUrl=${encodedURL(fromPageUrl)}&sceneName=${sceneName}&scenePhoto=${encodedURL(scenePhoto)}&fromPageTitle=${fromPageTitle}&p=${phone}&e=${email}&${userAgent.showHeader ? 'titleBar=hide' : ''}`\" name=\"ac\" frameborder=\"0\" width=\"100%\" scrolling=\"auto\" id=\"ActiveIframe\" class=\"activeiframe\"></iframe>\n  </div>\n</div>\n</template>\n<script>\nimport md5 from '@/utils/md5'\nimport utils from '@/utils/utils'\nimport personalApi from '@/http/service/index';\nimport Header from '@/components/header'\nimport { customServiceSceneMap } from '@/config/constMap'\n\nconst getUserAgent = (pid) => {\n  const userAgentMap = {\n    'h5': {\n      name: 'h5',\n      needUpAuth: false,\n      showHeader: true,\n      fromPageTitlePrefix: 'sc_h5_',\n      traceLogOrigin: 'h5',\n      device: 'browser',\n      defaultAccountId: 'zhijiashop',\n      pageTitle: '海尔智家商城在线客服',\n      pId: 'm'\n    },\n    'SyBirdH5': {\n      name: 'SyBirdH5',\n      showHeader: true,\n      needUpAuth: false,\n      fromPageTitlePrefix: 'sc_syn_',\n      traceLogOrigin: 'synApp',\n      defaultAccountId: 'ThreeWingedBird',\n      device: 'browser',\n      pageTitle: '三翼鸟在线客服',\n      pId: 'synapp'\n    },\n    'SyBird': {\n      name: 'SyBird',\n      showHeader: true,\n      needUpAuth: true,\n      fromPageTitlePrefix: 'sc_syn_',\n      traceLogOrigin: 'synApp',\n      defaultAccountId: 'ThreeWingedBird',\n      device: 'browser',\n      pageTitle: '三翼鸟在线客服',\n      pId: 'synapp'\n    },\n    'Uplus': {\n      name: 'Uplus',\n      showHeader: false,\n      needUpAuth: true,\n      fromPageTitlePrefix: 'sc_zhijia_',\n      traceLogOrigin: 'haierApp',\n      defaultAccountId: 'zhijiashop',\n      device: 'app',\n      pageTitle: '海尔智家商城在线客服',\n      pId: 'zjapp'\n    },\n    'sgApp': {\n      name: 'sgApp',\n      showHeader: false,\n      needUpAuth: false,\n      fromPageTitlePrefix: 'sc_sg_',\n      traceLogOrigin: 'ehaierApp',\n      defaultAccountId: 'zhijiavip',\n      device: 'browser',\n      pageTitle: '在线客服',\n      pId: 'sgapp'\n    }\n  }\n\n  let key = 'h5'\n\n  if (pid === 'synapp') {\n    key = 'SyBirdH5'\n  } else if (utils.isUplus()) {\n    key = 'Uplus'\n  } else if (utils.isSyBird()) {\n    key = 'SyBird'\n  } else if (utils.isSgRn()) {\n    key = 'sgApp'\n  }\n\n  return userAgentMap[key]\n}\n\nexport default {\n  components: {\n    Header\n  },\n  data () {\n    return {\n      urlHost: utils.isProdEnv() ? 'https://holcc.haier.net' : 'https://sip189.rrslexin.com',\n      userAgent: null,\n      userId: '',\n      accountId: '',\n      sign: '',\n      userName: '',\n      fromPageUrl: '',\n      fromPageTitle: '',\n      sceneId: '',\n      phone: '',\n      email: '',\n\n      sceneName: '',\n      scenePhoto: ''\n    }\n  },\n  created() {\n    this.userAgent = getUserAgent(this.$route.query.pid)\n    this.$route.meta.title = this.userAgent.pageTitle\n    this.sceneName = this.$route.query.sceneName || ''\n    this.scenePhoto = this.$route.query.scenePhoto || ''\n    this.fromPageUrl = this.$route.query.fromPageUrl || ''\n    this.accountId = this.$route.query.accountId || this.userAgent.defaultAccountId\n    this.sceneId = this.$route.query.sceneId\n    if (!customServiceSceneMap[this.sceneId]) this.sceneId = 'cj090'\n    this.fromPageTitle = `${this.userAgent.fromPageTitlePrefix}${customServiceSceneMap[this.sceneId]}`\n  },\n  mounted() {\n    // debugger\n    if (this.$util.isAlipay()) {\n      this.$toast({ message: '请拨打客服电话：400-828-7777', duration: 0 })\n      return\n    }\n    if (this.userAgent.needUpAuth) {\n      // U+ 登陆处理\n      this.$store.dispatch('handleUpAuth').then(isLogin => {\n        if (isLogin) {\n          this.initBase()\n        }\n      })\n    } else {\n      this.initBase()\n    }\n  },\n  methods: {\n    encodedURL(url) {\n      if (!url) return ''\n      if (window && window.encodeURIComponent) {\n        return window.encodeURIComponent(url)\n      }\n      return url\n    },\n    initBase() {\n      if (this.accountId !== this.userAgent.defaultAccountId) {\n        this.isCanGetCustomer(this.accountId).then(res => {\n          if (!res) {\n            this.accountId = this.userAgent.defaultAccountId\n          }\n          this.initService()\n        })\n      } else {\n        this.initService()\n      }\n    },\n    initService() {\n      // if (this.$util.isAlipay()) {\n      //   this.$toast({ message: '请拨打客服电话：400-828-7777', duration: 0 })\n      //   return\n      // }\n      // 非支付宝小程序走下边逻辑\n      let memberInfo = this.getMemberInfo()\n      if (!memberInfo) return\n      memberInfo.then(res => {\n        if (res.success) {\n          this.phone = res.data.mobile\n          this.email = res.data.email\n          this.userName = res.data.userName\n          this.userId = res.data.ucMemberId\n\n          if (this.userId) {\n            this.sign = md5.hex_md5(`accountId = ${this.accountId} and userId = ` + this.userId)\n            const data = {\n              userId: this.userId,\n              accountId: this.accountId,\n              sign: this.sign,\n              userName: this.userName,\n              fromPageUrl: this.fromPageUrl,\n              fromPageTitle: this.fromPageTitle,\n              origin: this.userAgent.traceLogOrigin\n            }\n            // 打印日志\n            this.traceLog(data)\n          } else {\n            this.$store.dispatch('doLogin')\n          }\n\n          this.$nextTick(i => {\n            let pageInfo = this.getBrowserInterfaceSize()\n            // document.getElementById('ActiveIframe').style.height = (pageInfo.pageHeight - 46) + 'px'\n            let frameDom = document.getElementById('frameContainer')\n            if (frameDom) {\n              let headerBaseHeight = 46\n              if (!this.userAgent.showHeader) {\n                headerBaseHeight = 0\n              }\n              frameDom.style.height = (pageInfo.pageHeight - headerBaseHeight) + 'px'\n            }\n          })\n        } else {\n          this.$toast(res.data.message)\n        }\n      }).catch(err => {\n        console.log(err)\n      })\n    },\n    /**\n     * @description 验证传入的88码是否开通商家客服\n    */\n    isCanGetCustomer(storeCode) {\n      return new Promise((resolve, reject) => {\n        const data = {\n          storeCode: storeCode\n        };\n        personalApi.getCustomer(data).then(res => {\n          if (res.data.success) {\n            resolve(res.data.result)\n          }\n        })\n      })\n    },\n    /**\n     * @description 获取会员手机号、邮箱（Base64加密）\n    */\n    getMemberInfo() {\n      if (!localStorage.getItem('mId')) {\n        this.$store.dispatch('doLogin')\n        return\n      }\n      return new Promise((resolve, reject) => {\n        const data = { memberId: localStorage.getItem('mId') };\n        personalApi.getMemberInfo(data).then(res => {\n          resolve(res.data)\n        })\n      })\n    },\n    /**\n     * @description 打印日志\n    */\n    traceLog(param) {\n      personalApi.traceLog(param).then(res => {\n      })\n    },\n    getBrowserInterfaceSize() {\n      var pageWidth = window.innerWidth;\n      var pageHeight = window.innerHeight;\n\n      if (typeof pageWidth !== 'number') {\n        // 在标准模式下面\n        if (document.compatMode === 'CSS1Compat') {\n          pageWidth = document.documentElement.clientWidth;\n          pageHeight = document.documentElement.clientHeight;\n        } else {\n          pageWidth = document.body.clientWidth;\n          pageHeight = window.body.clientHeight;\n        }\n      }\n\n      return {\n        pageWidth: pageWidth,\n        pageHeight: pageHeight\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.container{\n  padding-top: 46px;\n  overflow: hidden;\n  .activeiframe {\n    height: 100%;\n  }\n}\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./container.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./container.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./container.vue?vue&type=template&id=6b22936e&scoped=true&\"\nimport script from \"./container.vue?vue&type=script&lang=js&\"\nexport * from \"./container.vue?vue&type=script&lang=js&\"\nimport style0 from \"./container.vue?vue&type=style&index=0&id=6b22936e&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6b22936e\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../../node_modules/@sg/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./container.vue?vue&type=style&index=0&id=6b22936e&lang=scss&scoped=true&\""],"sourceRoot":""}