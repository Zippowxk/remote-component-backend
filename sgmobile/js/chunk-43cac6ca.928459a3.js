(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-43cac6ca"],{1727:function(e,t,s){},"280e":function(e,t,s){"use strict";s("6a91")},"57f0":function(e,t,s){},"6a91":function(e,t,s){},9741:function(e,t,s){"use strict";s("57f0")},db7b:function(e,t,s){"use strict";s.r(t);var i,a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"content"},[s("div",{staticClass:"tail-tips"},[e._v("温馨提示：提交支付后，信息将不能变更")]),s("div",{staticClass:"address",on:{click:e.fnChangeAddress}},[e._m(0),s("div",{staticClass:"address-box"},[e.pageInfo.address&&e.pageInfo.address.coN?s("div",{staticClass:"address-top"},[s("div",[e._v("收货人："+e._s(e.pageInfo.address.coN))]),s("div",[e._v(e._s(e.pageInfo.address.mb))])]):e._e(),s("div",{staticClass:"address-bottom"},[s("div",{staticClass:"address-center van-multi-ellipsis--l2"},[!e.pageInfo.address||e.pageInfo.address&&!e.pageInfo.address.coN?s("div",{staticClass:"no-address"},[e._v("点击添加收货地址")]):s("div",{staticClass:"has-address"},[s("div",[e._v("收货地址："+e._s(e.pageInfo.address.rn)+" "+e._s(e.pageInfo.address.addr))])])])])]),e._m(1),s("img",{staticClass:"underline",attrs:{alt:"",src:e.$cdnImageUrl+"/order/icon-line-red.png"}})]),s("ul",{staticClass:"goods-info-wrap"},e._l(e.pageInfo.tailOrderProductVoList,(function(t,i){return s("li",{key:i,staticClass:"goods"},[s("div",{staticClass:"goods-box"},[s("div",{staticClass:"goods-top pb"},[s("div",{staticClass:"goods-left"},[s("img",{attrs:{src:e._f("imageToHttps")(t.image)}})]),s("div",{staticClass:"goods-right"},[s("div",{staticClass:"goods-name"},[e._v(e._s(t.pName))]),t.an?s("div",{staticClass:"goods-attr"},[e._v("已选 "+e._s(t.an))]):e._e(),s("div",{staticClass:"goods-message"},[s("div",[e._v("￥"+e._s(e._f("formatPrice")(t.price)))]),s("div",[e._v("×"+e._s(t.num))])]),s("div",{staticClass:"goods-message"},[s("div",{class:{hidden:!t.pma}},[e._v("小计：下单立减"+e._s(t.pma)+"元")]),s("div",{class:{"delet-price":t.price*t.num!=t.payAmt,"orange-color":t.price*t.num==t.payAmt}},[e._v(" ￥"+e._s(e._f("formatPrice")(t.price*t.num))+" ")])])])]),t.price*t.num!=t.payAmt?s("div",{staticClass:"goods-center"},[e._v("￥"+e._s(e._f("formatPrice")(t.payAmt)))]):e._e()])])})),0),s("div",{staticClass:"pay-details"},[s("div",{staticClass:"strip",on:{click:e.fnOpenAvailableVoucher}},[s("div",{staticClass:"left"},[e._v("优惠券")]),e._m(2)]),e.isShowUserEcard?s("div",{staticClass:"strip",on:{click:e.fnShowEcardPop}},[s("div",{staticClass:"left"},[e._v(" 礼品卡(智家e卡) "),e.ecardSelectNum?s("span",{staticClass:"card-select-tag"},[e._v("已选"+e._s(e.ecardSelectNum)+"张")]):e._e()]),s("div",{staticClass:"right"},[e.ecardListYHPrice?s("div",{staticClass:"couponAmt",staticStyle:{color:"#FF2E2E"}},[e._v("-￥"+e._s(e.ecardListYHPrice))]):e.pageInfo.usableEcardCount?s("div",{staticStyle:{"font-size":"0.24rem",color:"#999"}},[e._v(e._s(e.pageInfo.usableEcardCount)+"张可用")]):s("div",{staticStyle:{"font-size":"0.24rem",color:"#999"}},[e._v("暂无可用")]),e._m(3)])]):e._e(),s("div",{staticClass:"strip",on:{click:e.fnOpenInvoice}},[s("div",{staticClass:"left"},[e._v("发票信息")]),s("div",{staticClass:"right"},[s("div",{staticClass:"invoice"},[e._v(" "+e._s(e.invoiceText)+" ")]),e._m(4)])])]),s("div",{staticClass:"pay-type-container"},e._l(e.calculationList,(function(t,i){return s("div",{directives:[{name:"show",rawName:"v-show",value:1!=e.pageInfo.ot,expression:"pageInfo.ot != 1"}],key:i,class:{"pay-type":i!=e.calculationList.length-1}},[e._e(),e._e(),e._e(),"diamond"==t.detail.benefitType?s("div",{staticClass:"strip"},[s("div",{staticClass:"left"},[s("div",{staticClass:"left-left"},[e._v("钻石")]),s("div",{staticClass:"left-right"},[s("div",[e._v("共"+e._s(t.detail.count||0)+"钻石 可用"+e._s(t.canUseMoney)+"钻石 抵"+e._s(t.purposeMoney)+"元")])])]),s("van-switch",{attrs:{"active-color":"#2283E2",size:"15px",disabled:!(t.canUseMoney&&t.canUseMoney>0)},on:{change:function(s){return e.fnSwitchChange(t)}},model:{value:t.canUse,callback:function(s){e.$set(t,"canUse",s)},expression:"item.canUse"}})],1):e._e()])})),0),s("div",{staticClass:"shop-price"},[s("div",{staticClass:"strip"},[s("div",{staticClass:"left"},[e._v("商品金额")]),s("div",{staticClass:"right"},[e._v("￥"+e._s(e._f("formatPrice")(e.pageInfo.productAmount||0)))])]),e.pageInfo.couponAmount?s("div",{staticClass:"strip"},[s("div",{staticClass:"left"},[e._v("优惠券")]),s("div",{staticClass:"right"},[e._v("-￥"+e._s(e._f("formatPrice")(e.pageInfo.couponAmount)))])]):e._e(),e.pageInfo.ipm?s("div",{staticClass:"strip"},[s("div",{staticClass:"left"},[e._v("满减")]),s("div",{staticClass:"right"},[e._v("-￥"+e._s(e._f("formatPrice")(e.pageInfo.ipm)))])]):e._e(),e.isUseSGBPay?s("div",{staticClass:"strip"},[s("div",{staticClass:"left"},[e._v("智家宝")]),s("div",{staticClass:"right"},[e._v("-￥"+e._s(e._f("formatPrice")(e.sgbPurposeMoney)))])]):e._e(),e.isUseJBPay?s("div",{staticClass:"strip"},[s("div",{staticClass:"left"},[e._v("金币")]),s("div",{staticClass:"right"},[e._v("-￥"+e._s(e._f("formatPrice")(e.insurancePurposeMoney)))])]):e._e(),e.isUseSeaShellPay?s("div",{staticClass:"strip"},[s("div",{staticClass:"left"},[e._v("积分")]),s("div",{staticClass:"right"},[e._v("-￥"+e._s(e._f("formatPrice")(e.seashellPurposeMoney)))])]):e._e(),e.isUseDiamondPay?s("div",{staticClass:"strip"},[s("div",{staticClass:"left"},[e._v("钻石")]),s("div",{staticClass:"right"},[e._v("-￥"+e._s(e._f("formatPrice")(e.diamondPurposeMoney)))])]):e._e()]),s("div",{staticClass:"pay-money"},[s("div",{staticClass:"left"},[e._v(" 实付款： "),s("div",{staticClass:"final-pay"},[e._v("￥"+e._s(e._f("formatPrice")(e.actPayMoney)))])]),s("div",{staticClass:"right",on:{click:e.fnSubmit}},[e._v("确认提交")])]),s("van-popup",{attrs:{position:"bottom"},on:{close:e.closeEcardPop},model:{value:e.eCardPicker,callback:function(t){e.eCardPicker=t},expression:"eCardPicker"}},[s("ecard-pop",{attrs:{isTailOrder:e.orderSn},on:{close:e.closeEcardPop,add:e.addEcard,reset:e.resetEcard,selectchange:e.ecardSelectChange}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:e.popupShow,expression:"popupShow"}],staticClass:"dialog-container"},[s("div",{staticClass:"bg"}),s("CaptchaDialog",{staticClass:"dialog",attrs:{show:e.popupShow,preGetTime:e.preGetTime,desc:"当使用虚拟资产时，需获取当前登录手机号的验证码核实用户身份"},on:{submit:e.onSubmitCaptcha,close:e.onCloseCaptchaDialog,resend:e.sendSmsCaptch}})],1)],1)},n=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"left"},[s("img",{staticClass:"address-icon",attrs:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAoCAMAAAChHKjRAAAAP1BMVEVHcEwvLy8zMzMzMzMzMzMzMzMzMzMtLS0xMTEzMzMzMzMzMzMxMTEzMzMzMzMzMzMyMjIzMzMyMjIyMjIzMzOIoG2EAAAAFHRSTlMAD3b0lt3EBin76agbU2KHNtFCuFYVHOEAAAGSSURBVDjLnVTbloQgDBO5SLkpmv//1kVGirrsnrPLy8w4MU3Slmn667Gzz5KkMyouY8SSMvqRyg4wUQNOJSumJeyzAUiJN40C8r2GVQS3PzDCgOaXDFuepSfGbd9FFvbYf3roMPIyg/jdBGnHjhX0JUK4O+uzYsbcSA9+GmZ/+LnX3iFrEIvDzlKpJkmKnRqkD1g3TDHt0548wTRUhDk/Vqzd5MeA1fAtHaITfzTZWzdpJZr3XL9p2OZ3ZcErFNOfoiSuRjL6pGKhaw2BcImU6N1bIB8gZnLosyHgHiCuYm7BX86rpsjKavJm6hle7Sj8trbXcw9XruFEc1DrBqKrVzvBn69ZD9p5DtRVtRFECWhThl02dUFeikvSre1BOZz7EPpAHWygz8piN9vj2ohs50zDmRP61qn4w/x65OUxy2G0B493y7jl976WACm+q5sXKhKnzhvwRqXvmIrK4a5ngCmoDL3dNvyHVAzk5x9x9MaMbohz4zY9uj/uarOdy9qF327NQlLOuvx+twol8z7953wBuLoUgyWE9uwAAAAASUVORK5CYII="}})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"right"},[s("img",{staticClass:"more",attrs:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAASBAMAAACdhyI/AAAAFVBMVEVHcEyZmZmXl5eenp6ampqZmZmZmZnA+BYuAAAABnRSTlMA0xYVgYLuQiDGAAAAJklEQVQI12NggAJWBTDlJgSmDBPBXGYxIrhQCiKImwMzGmoRGAAAgu0GKQKrDXQAAAAASUVORK5CYII="}})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"right"},[s("img",{staticClass:"more",attrs:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAASBAMAAACdhyI/AAAAFVBMVEVHcEyZmZmXl5eenp6ampqZmZmZmZnA+BYuAAAABnRSTlMA0xYVgYLuQiDGAAAAJklEQVQI12NggAJWBTDlJgSmDBPBXGYxIrhQCiKImwMzGmoRGAAAgu0GKQKrDXQAAAAASUVORK5CYII="}})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"img"},[s("img",{staticClass:"more",attrs:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAASBAMAAACdhyI/AAAAFVBMVEVHcEyZmZmXl5eenp6ampqZmZmZmZnA+BYuAAAABnRSTlMA0xYVgYLuQiDGAAAAJklEQVQI12NggAJWBTDlJgSmDBPBXGYxIrhQCiKImwMzGmoRGAAAgu0GKQKrDXQAAAAASUVORK5CYII="}})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"right"},[s("img",{staticClass:"more",attrs:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAASBAMAAACdhyI/AAAAFVBMVEVHcEyZmZmXl5eenp6ampqZmZmZmZnA+BYuAAAABnRSTlMA0xYVgYLuQiDGAAAAJklEQVQI12NggAJWBTDlJgSmDBPBXGYxIrhQCiKImwMzGmoRGAAAgu0GKQKrDXQAAAAASUVORK5CYII="}})])}],o=(s("e7e5"),s("d399")),r=(s("8a58"),s("e41f")),c=(s("9e6b"),s("c41f")),l=(s("8fec"),s("7bd9")),u=(s("b000"),s("1a23")),d=s("a34a"),p=s.n(d),h=s("85e4"),m=s("bbc2"),f=s("e845");function v(e,t,s,i,a,n,o){try{var r=e[n](o),c=r.value}catch(l){return void s(l)}r.done?t(c):Promise.resolve(c).then(i,a)}function g(e){return function(){var t=this,s=arguments;return new Promise((function(i,a){var n=e.apply(t,s);function o(e){v(n,i,a,o,r,"next",e)}function r(e){v(n,i,a,o,r,"throw",e)}o(void 0)}))}}function y(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function A(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?y(Object(s),!0).forEach((function(t){C(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):y(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function C(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var M=function(){return s.e("chunk-674b1746").then(s.bind(null,"3300"))},b={components:(i={CaptchaDialog:f["a"],ecardPop:M},C(i,u["a"].name,u["a"]),C(i,l["a"].name,l["a"]),C(i,c["a"].name,c["a"]),C(i,r["a"].name,r["a"]),C(i,o["a"].name,o["a"]),i),data:function(){return{orderSn:"",pageInfo:{},finalPrice:0,eCardPicker:!1,popupShow:!1,isShowUserEcard:!1,pushComputedPrice:[],preGetTime:0,submitCAPTCHAOnce:0,calculationList:[],sgbDetail:"",sgbPurposeMoney:0,sgbUseMoney:0,insuranceDetail:"",insurancePurposeMoney:0,insuranceUseMoney:0,seaShellDetail:"",seashellPurposeMoney:0,seaShellUseMoney:0,diamondDetail:"",diamondPurposeMoney:0,diamondUseMoney:0,initCheckStatus:[!1,!1,!1,!1],isUseSGBPay:!1,isUseJBPay:!1,isUseSeaShellPay:!1,isUseDiamondPay:!1,value:"",showKeyboard:!0,isSubmit:!1,paying:!1}},computed:{actPayMoney:function(){console.log("diamondPurposeMoney ==>",this.diamondPurposeMoney);var e=this.pageInfo.initPam+this.pageInfo.sam-this.ecardListYHPrice-this.diamondPurposeMoney;return console.log(e<0?0:e.toFixed(2),"actPayMoney"),e<0?0:e.toFixed(2)},enableUseEcard:function(){return this.actPayMoney-this.pageInfo.sam>0},ecardSelectNum:function(){return this.pushComputedPrice.filter((function(e){return e.cardNo})).length},ecardListYHPrice:function(){var e=0;return this.pushComputedPrice.forEach((function(t){t.cardNo&&(e+=t.price)})),e>this.pageInfo.initPam?this.pageInfo.initPam:(console.log(e,"ecardListYHPrice"),e>0?e.toFixed(2):e)},isWDZ:function(){return this.$store.getters.getHasStore},invoiceText:function(){var e=this.pageInfo;return null!==e&&void 0!==e&&e.inv?0===e.inv.invoiceFlag?"本次不开发票":2===e.inv.it?"增值税电子普通发票-"+(e.inv.iti||""):3===e.inv.it?"增值税纸质普通发票-"+(e.inv.iti||""):1===e.inv.it?"增值税专用发票-"+(e.inv.bc||""):4===e.inv.it?"增值税电子专用发票-"+(e.inv.bc||""):"":""}},activated:function(){this.isUseSGBPay=!1,this.isUseJBPay=!1,this.isUseSeaShellPay=!1,this.orderSn=this.$route.query.orderSn,this.getTailOrder()},methods:{fnShowEcardPop:function(){this.eCardPicker=!0},closeEcardPop:function(){this.eCardPicker=!1},resetEcard:function(){console.log(this.pageInfo.oam),console.log("reset pop pop pop"),this.eCardPicker=!1,this.pushComputedPrice=[],this.computedDiamondUseMoney()},addEcard:function(){this.getEcardInfo(),this.resetEcard()},ecardSelectChange:function(e){if(this.enableUseEcard)if(this.actPayMoney>this.pageInfo.sam&&!e.isSelected){var t=this.actPayMoney-this.pageInfo.sam;console.log(t),this.pushComputedPrice.push({cardNo:e.cardNo,id:e.smartEcardId,balance:e.balance,price:e.balance>t?t:e.balance}),e.isSelected=!0,console.log(this.pushComputedPrice,"pushComputedPrice")}else this.removeArrElm(this.pushComputedPrice,"cardNo",e.cardNo),e.isSelected=!1;else{if(!e.isSelected)return void this.$toast("目前订单中已没有可用于充抵的金额");this.removeArrElm(this.pushComputedPrice,"cardNo",e.cardNo),e.isSelected=!1,console.log("delete")}this.computedDiamondUseMoney()},computedDiamondUseMoney:function(){var e=this;console.log("computedDiamondUseMoney",this.calculationList),this.isUseDiamondPay?(console.log(this.diamondPurposeMoney,this.actPayMoney,"aa"),this.calculationList.forEach((function(t){if("diamond"===t.detail.benefitType&&t.detail.count>e.diamondPurposeMoney&&e.actPayMoney-e.pageInfo.sam>=1){t.canUse=!1,e.isUseDiamondPay=!1,e.diamondPurposeMoney=0;var s=t.detail.count>e.actPayMoney-e.pageInfo.sam?e.actPayMoney-e.pageInfo.sam:t.detail.count;console.log(e.diamondPurposeMoney,"bbb=======>>>>>>"),t.purposeMoney=Math.floor(s),t.canUseMoney=Math.floor(s)}}))):this.calculationList.forEach((function(t){"diamond"===t.detail.benefitType&&(e.diamondUseMoney=t.detail.count>e.actPayMoney-e.pageInfo.sam?e.actPayMoney-e.pageInfo.sam:t.detail.count,console.log(e.diamondUseMoney,"aaa=======>>>>>>"),t.purposeMoney=Math.floor(e.diamondUseMoney),t.canUseMoney=Math.floor(e.diamondUseMoney))}))},removeArrElm:function(e,t,s){e.splice(e.findIndex((function(e){return e[t]===s})),1),this.pushComputedPrice.forEach((function(e){e.cardNo&&(e.price=e.balance)}))},getEcardInfo:function(){var e=this,t={cardType:1,pageNo:1,pageSize:20,orderSn:this.orderSn};this.$http.post(m["a"].getSmartEcardListForTailOrder,t).then((function(t){var s=t.data,i=s;i.success&&(e.pageInfo=A(A({},e.pageInfo),{},{usableEcardCount:i.totalCount||0}))}))},getTailOrder:function(){var e=this;return new Promise((function(t,s){Object(h["hb"])({orderSn:e.orderSn}).then((function(s){s.success?(e.pageInfo=Object.assign({pam:s.data.orderAmount,sam:s.data.orderAmount-s.data.productAmount,inv:s.data.invoices},s.data),e.pageInfo.initPam=e.pageInfo.pam,e.isShowUserEcard=!(e.$util.isSyBird()||e.$util.isSyBirdH5()),e.diamondPurposeMoney=0,e.calculationList=s.data&&s.data.bl&&s.data.bl.map((function(t){return"diamond"===t.benefitType?(e.diamondUseMoney=t.count>e.pageInfo.initPam?e.pageInfo.initPam:t.count,{purposeMoney:Math.floor(e.diamondUseMoney),canUseMoney:Math.floor(e.diamondUseMoney),detail:t,canUse:!1}):{purposeMoney:"",canUseMoney:"",detail:t,canUse:!1}})),e.getEcardInfo(),t()):Object(o["a"])(s.message)}))}))},calculationSgbData:function(e){e.oam=e.orderAmount,e.sam=e.orderAmount-e.productAmount;var t=this,s=[],i="",a="",n="",o="",r=0,c=0,l=0,u=0,d=0,p=0,h=0,m=0;if(e.bl&&e.bl.length>0)for(var f=0;f<e.bl.length;f++)"sgb"===e.bl[f].benefitType?(i=e.bl[f],r=t.mul((e.oam||0)-(e.sam||0),i.quota||0),r>(e.oam||0)-(e.sam||0)&&(r=(e.oam||0)-(e.sam||0)),r>(i.count||0)/(i.proportion||0)&&(r=i.count/i.proportion),r<.01&&(r=0),d=t.mul(r,i.proportion),s.push({purposeMoney:r,canUseMoney:d,detail:i,canUse:!1})):"insurance"===e.bl[f].benefitType?(a=e.bl[f],c=t.mul((e.oam||0)-(e.sam||0),a.quota||0),c>(e.oam||0)-(e.sam||0)&&(c=(e.oam||0)-(e.sam||0)),c>(a.count||0)/(a.proportion||0)&&(c=a.count/a.proportion),p=Math.floor(t.mul(c,a.proportion)),c=p/a.proportion||0,s.push({purposeMoney:c,canUseMoney:p,detail:a,canUse:!1})):"seashell"===e.bl[f].benefitType?(n=e.bl[f],l=t.mul((e.oam||0)-(e.sam||0),n.quota||0),l>(e.oam||0)-(e.sam||0)&&(l=(e.oam||0)-(e.sam||0)),l>(n.count||0)/(n.proportion||0)&&(l=n.count/n.proportion),h=Math.floor(t.mul(l,n.proportion)),l=h/n.proportion||0,s.push({purposeMoney:l,canUseMoney:h,detail:n,canUse:!1})):"diamond"===e.bl[f].benefitType&&(o=e.bl[f],u=t.mul((e.oam||0)-(e.sam||0),o.quota||0),u>(e.oam||0)-(e.sam||0)&&(u=(e.oam||0)-(e.sam||0)),u>(o.count||0)/(o.proportion||0)&&(u=o.count/o.proportion),m=Math.floor(t.mul(u,o.proportion)),u=m/o.proportion||0,s.push({purposeMoney:u,canUseMoney:m,detail:o,canUse:!1})),this.calculationList=s;this.sgbDetail=i,this.sgbPurposeMoney=r.toFixed(2),this.sgbUseMoney=d.toFixed(2),this.insuranceDetail=a,this.insurancePurposeMoney=c.toFixed(2),this.insuranceUseMoney=Math.floor(p),this.seaShellDetail=n,this.seashellPurposeMoney=l.toFixed(2),this.seaShellUseMoney=Math.floor(h),this.diamondDetail=o,this.diamondPurposeMoney=u.toFixed(2),this.diamondUseMoney=Math.floor(m),this.initCheckStatus=[!1,!1,!1,!1]},mul:function(e,t){var s=0,i="",a="";e&&null!=e&&(i=e.toString()),t&&null!=t&&(a=t.toString());try{s+=i.split(".")[1].length}catch(n){}try{s+=a.split(".")[1].length}catch(n){}return Number(i.replace(".",""))*Number(a.replace(".",""))/Math.pow(10,s)},fnChangeAddress:function(){this.pageInfo.canChange?this.$router.push({path:"/address",query:{from:2,orderSn:this.orderSn}}):Object(o["a"])("不允许修改地址")},fnOpenAvailableVoucher:function(e){var t;t=e.proId?{type:"1",productId:e.proId,sku:e.sku,from:"tailOrder"}:{type:"2",from:"tailOrder",orderSn:this.orderSn},this.$router.push({path:"/orderVoucher",query:t})},fnOpenInvoice:function(){this.pageInfo.canInvoice?this.$router.push({name:"invoice",query:{inv:this.pageInfo.invoices,from:"tailOrder",orderSn:this.orderSn}}):Object(o["a"])("不允许修改发票信息")},fnSwitchChange:function(e){console.log("fnSwitchChange"),"diamond"===e.detail.benefitType&&(this.isUseDiamondPay=e.canUse,e.canUse?this.diamondPurposeMoney=e.purposeMoney:(this.diamondPurposeMoney=0,this.pushComputedPrice.forEach((function(e){e.cardNo&&(e.price=e.balance)})),this.computedDiamondUseMoney()))},checkAuthThree:function(){var e=this,t=this;return new Promise((function(s,i){e.$http.get(m["a"].TRUE_REALNAMEAUTH).then((function(e){var i=e.data;!0===i.success?i.data.authCode&&i.data.authCode>=4||i.data.isAuth&&null!=i.data.bankCard?s():t.$router.push({name:"bindcard"}):Object(o["a"])(i.message)}))}))},totalPriceFn:function(e,t){var s=this.pageInfo.oam;"sgb"===e.detail.benefitType?this.sgbPurposeMoney=e.purposeMoney:"insurance"===e.detail.benefitType?this.insurancePurposeMoney=e.purposeMoney:"seashell"===e.detail.benefitType?this.seashellPurposeMoney=e.purposeMoney:"diamond"===e.detail.benefitType&&(this.diamondPurposeMoney=e.purposeMoney),this.isUseJBPay&&!1===this.initCheckStatus[0]&&(this.pageInfo.oam=s-this.insurancePurposeMoney,this.initCheckStatus[0]=!0),this.isUseSGBPay&&!1===this.initCheckStatus[1]&&(this.pageInfo.oam=s-this.sgbPurposeMoney,this.initCheckStatus[1]=!0),this.isUseSeaShellPay&&!1===this.initCheckStatus[2]&&(this.pageInfo.oam=s-this.seashellPurposeMoney,this.initCheckStatus[2]=!0),this.isUseDiamondPay&&!1===this.initCheckStatus[3]&&(this.pageInfo.oam=s-this.diamondPurposeMoney,this.initCheckStatus[3]=!0);for(var i=this.calculationList.length-1;i>=0;i--)i!==t&&!this.calculationList[i].canUse&&this.pageInfo.oam<this.calculationList[i].purposeMoney&&(this.calculationList[i].canUseMoney-=this.calculationList[i].detail.proportion*this.calculationList[i].detail.quota*this.calculationList[t].purposeMoney,this.calculationList[i].purposeMoney=this.calculationList[i].canUseMoney*this.calculationList[i].detail.quota);!1===e.canUse&&(this.pageInfo.oam=this.finalPrice,this.calculationSgbData(this.pageInfo),this.isUseSGBPay=!1,this.isUseJBPay=!1,this.isUseSeaShellPay=!1,this.isUseDiamondPay=!1)},fnSubmit:function(){var e=this;return g(p.a.mark((function t(){return p.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.isUseSGBPay||e.isUseJBPay||e.isUseSeaShellPay||e.isUseDiamondPay||-1!==e.pushComputedPrice.findIndex((function(e){return e.cardNo}))?(console.log("提交订单--使用智家宝"),e.popupShow=!0,e.sendSmsCaptch()):(console.log("提交订单--不使用智家宝"),e.asynSubmitOrder());case 1:case"end":return t.stop()}}),t)})))()},onSubmitCaptcha:function(e){this.value=e,this.asynSubmitOrder()},onCloseCaptchaDialog:function(){this.popupShow=!1},sendSmsCaptch:function(){var e=this;this.submitCAPTCHAOnce<=5&&Date.now()-this.preGetTime<=6e4||(this.submitCAPTCHAOnce=0,Object(h["Eb"])({}).then((function(t){t.success?e.preGetTime=Date.now():Object(o["a"])(t.message)})))},onInput:function(e){this.value=(this.value+e).slice(0,6),6===this.value.length&&(this.popupShow=!1,this.asynSubmitOrder())},onDelete:function(){this.value=this.value.slice(0,this.value.length-1)},asynSubmitOrder:function(){var e=this;if(!this.isSubmit){this.isSubmit=!0;var t=[];if(this.isUseSGBPay){var s={amt:this.sgbPurposeMoney||0,benefitType:"sgb",count:this.sgbPurposeMoney||0};t.push(s)}if(this.isUseJBPay){var i={amt:this.insurancePurposeMoney||0,benefitType:"insurance",count:(this.insurancePurposeMoney*this.insuranceDetail.proportion||0).toFixed(0)};t.push(i)}if(this.isUseSeaShellPay){var a={amt:this.seashellPurposeMoney||0,benefitType:"seashell",count:(this.seashellPurposeMoney*this.seaShellDetail.proportion||0).toFixed(0)};t.push(a)}if(this.isUseDiamondPay){var n={amt:this.diamondPurposeMoney||0,benefitType:"diamond",count:this.diamondPurposeMoney||0};t.push(n)}if(-1!==this.pushComputedPrice.findIndex((function(e){return e.cardNo}))){var r={amt:this.ecardListYHPrice,benefitType:"ecard",count:this.ecardListYHPrice,bids:[]};this.pushComputedPrice.forEach((function(e){e.cardNo&&r.bids.push(e.id)})),t.push(r)}console.log(t),Object(h["Ob"])({captcha:this.value,ch:1,isBooking:0,benefitList:t,orderSn:this.orderSn}).then((function(t){e.isSubmit=!1,t.success?(e.paying=!0,null==t.data.ps||101!==t.data.ps&&"101"!==t.data.ps?null!=t.data.pyc&&["cod","giftCard","sgbpay"].indexOf(t.data.pyc)>=0?(e.paying=!1,e.fnOpenPayStatus("submit")):e.$router.replace({path:"/orderCashier/".concat(t.data.os)}):(e.paying=!1,e.fnOpenPayStatus("submit"))):Object(o["a"])(t.message)}))}},fnOpenPayStatus:function(e){this.$router.replace('/payState?data={"is_success":"T"}')}}},P=b,S=(s("280e"),s("9741"),s("2877")),_=Object(S["a"])(P,a,n,!1,null,"1f8b427e",null);t["default"]=_.exports},e845:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"captcha-dialog-page"},[s("div",{staticClass:"close-btn",on:{click:e.close}},[s("img",{staticClass:"close",attrs:{src:e.$cdnImageUrl+"/order/home_common_control-close.png",alt:""}})]),e._m(0),s("div",{staticClass:"des"},[e._v(e._s(e.desc))]),s("div",{staticClass:"input-field flex"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.inputValue,expression:"inputValue"}],ref:"inputSMS",staticClass:"password-input",attrs:{inputmode:"search"},domProps:{value:e.inputValue},on:{input:[function(t){t.target.composing||(e.inputValue=t.target.value)},e.change]}}),s("div",{staticClass:"get-messge",style:{color:e.color},on:{click:e.resend}},[e._v(" "+e._s(e.canResendMSG?"重新获取验证码":e.farToResend+"s后获取"))])]),s("div",{staticClass:"divider"}),e.phone?s("div",{staticClass:"phone"},[e._v("验证码已发送至"+e._s(e.isBankPhone?"银行预留":"")+"手机号"+e._s(e.phone))]):e._e(),s("div",{staticClass:"btn-area",style:{"background-color":6===e.inputValue.length?"#2878FF":"#dddddd"},on:{click:e.sumitCaptcha}},[e._v(" 确定 ")])])},a=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"title"},[s("div",{staticClass:"title-name"},[e._v("身份校验")])])}],n={props:{show:{type:Boolean},preGetTime:{type:Number},desc:{type:String,default:function(){return""}},isBankPhone:{type:Boolean,default:function(){return!0}},phone:{type:String,defalut:function(){return""}}},data:function(){return{inputValue:"",now:null,fdInterval:null}},computed:{color:function(){return this.canResendMSG?"#2878FF":"#999"},farToResend:function(){return Number(this.now-this.preGetTime)<0?60:this.now-this.preGetTime>=6e4?0:60-Number((this.now-this.preGetTime)/1e3).toFixed(0)},canResendMSG:function(){return 0===this.farToResend}},watch:{show:{handler:function(e,t){var s=this;e?(this.now=Date.now(),this.fdInterval=setInterval((function(){s.now=Date.now()}),1e3),this.$nextTick((function(){s.$refs.inputSMS.focus()}))):this.fdInterval&&clearInterval(this.fdInterval)},immediate:!0}},created:function(){var e=this;this.now=Date.now(),this.fdInterval=setInterval((function(){e.now=Date.now()}),1e3)},mounted:function(){},destroyed:function(){this.fdInterval&&clearInterval(this.fdInterval)},methods:{resend:function(){this.$emit("resend")},change:function(e){console.log(e.keyCode),this.inputValue=this.inputValue.replace(/[^\d]/g,""),this.inputValue=this.inputValue.replace("e",""),console.log(this.inputValue),this.inputValue.length>6&&(this.inputValue=this.inputValue.slice(0,6))},sumitCaptcha:function(){console.log("submit"),this.inputValue.length<6||(this.$emit("submit",this.inputValue),this.inputValue="")},close:function(){this.$emit("close")}}},o=n,r=(s("ebe9"),s("2877")),c=Object(r["a"])(o,i,a,!1,null,"11a4f73d",null);t["a"]=c.exports},ebe9:function(e,t,s){"use strict";s("1727")}}]);
//# sourceMappingURL=chunk-43cac6ca.928459a3.js.map