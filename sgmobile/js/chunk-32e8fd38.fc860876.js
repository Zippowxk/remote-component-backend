(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-32e8fd38"],{"0664":function(t,e,n){},"06ea":function(t,e,n){"use strict";n("70463")},"25e9":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("div",{class:{"coupon-value-label":!0,"home-style":t.forHomePage},style:{color:t.textColor}},["FIXED_CASH_COUPON"===t.couponType||"REBATE_COUPON"===t.couponType?n("span",{staticClass:"symbol"},[t._v("￥")]):t._e(),n("span",{staticClass:"integer",style:{fontSize:t.fontSize}},[t._v(t._s(t._f("formatPriceInt")(t.couponDisplayValue)))]),t.withFloat?n("span",{staticClass:"float"},[t._v(t._s(t._f("formatPriceFloat")(t.couponDisplayValue)))]):t._e(),"DISCOUNT_COUPON"===t.couponType?n("span",{staticClass:"sales"},[t._v("折")]):t._e()])])},a=[],i={name:"couponValueLabel",props:{couponValue:{type:String,default:"0"},couponType:{type:String,default:"FIXED_CASH_COUPON"},forHomePage:{type:Boolean,default:!1},maxFontSize:{type:String,default:"0.64"},textColor:{type:String,default:"#ED2856"}},computed:{fontSize:function(){return this.forHomePage?String(this.couponDisplayValue).length<6?"0.40rem":6===String(this.couponDisplayValue).length?"0.38rem":String(this.couponDisplayValue).length>6?"0.32rem":this.maxFontSize+"rem":String(this.couponDisplayValue).length<6?this.maxFontSize+"rem":6===String(this.couponDisplayValue).length?.875*this.maxFontSize+"rem":String(this.couponDisplayValue).length>6?.68*this.maxFontSize+"rem":this.maxFontSize+"rem"},withFloat:function(){var t=this.couponDisplayValue.split(".");return!!(t&&t.length>1&&"00"!==t[1]&&"0"!==t[1])},couponDisplayValue:function(){return"DISCOUNT_COUPON"===this.couponType?String(Number(this.couponValue)/10):this.couponValue}}},s=i,r=(n("4ff6"),n("2877")),c=Object(r["a"])(s,o,a,!1,null,"5a48cfec",null);e["a"]=c.exports},2869:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{background:"white",height:"100%"}},[t.isSkeletonLoading?n("skeleton",{attrs:{nums:4,iheight:".4rem"}}):n("div",[n("div",{staticClass:"container"},[t.detail?n("div",{staticClass:"coupon-container"},[n("div",{staticClass:"content-wrapper"},[n("div",{staticClass:"value-wrapper"},[n("coupon-value-label",{staticStyle:{"background-color":"transparent"},attrs:{couponValue:t.detail.couponValue,couponType:t.detail.couponType}})],1),n("div",{staticClass:"info-wrapper"},[n("div",{staticClass:"info"},[n("p",{staticClass:"info-text"},["PRODUCT"===t.detail.scope?n("span",{staticClass:"singleItem"},[t._v("单品")]):t._e(),"ORDER"===t.detail.scope?n("span",{staticClass:"singleItem"},[t._v("订单")]):t._e(),t._v(" "+t._s(t.detail.minAmountDoc)+" ")]),n("p",{staticClass:"info-text"},[t._v(t._s(t.detail.couponTemplateName))]),n("p",{staticClass:"info-text"},[t._v(t._s(t.detail.startTime)+"—"+t._s(t.detail.endTime))])]),n("div",{staticClass:"receive"},["1"!==t.detail.displayType?n("div",{staticClass:"percent-container"}):t._e(),"1"===t.detail.displayType?n("div",{staticClass:"not-received"},[n("span",{staticClass:"receive-btn",on:{click:function(e){return e.stopPropagation(),t.getCoupon()}}},[t._v("立即领取")])]):"2"===t.detail.displayType?n("div",{staticClass:"received"},[n("span",{staticClass:"receive-disabled",on:{click:function(e){return e.stopPropagation(),t.useCoupon.apply(null,arguments)}}},[t._v("立即使用")]),n("img",{staticClass:"received-img",attrs:{src:t.$cdnImageUrl+"/shop/coupon-received.png"}})]):"3"===t.detail.displayType?n("div",{staticClass:"received"},[n("span",{staticClass:"receive-disabled",on:{click:function(e){return e.stopPropagation(),t.appointmentTip.apply(null,arguments)}}},[t._v("预约")])]):"4"===t.detail.displayType?n("div",{staticClass:"received"},[n("span",{staticClass:"receive-disabled"},[t._v("已设提醒")])]):"5"===t.detail.displayType?n("div",{staticClass:"received"},[n("span",{staticClass:"receive-disabled"},[t._v("已抢光")])]):n("div",{staticClass:"sold-out"},[n("img",{staticClass:"sold-out-img",attrs:{src:t.$cdnImageUrl+"/shop/coupon-sold-out.png"}})])])])]),n("img",{staticClass:"type-icon",attrs:{src:t.iconSrc,alt:""}}),n("img",{staticClass:"new-coupon-bg",attrs:{src:t.$cdnImageUrl+"/shop/yhq-new-coupon-bg.png"}})]):t._e(),!t.detail||"3"!==t.detail.displayType&&"4"!==t.detail.displayType?t._e():n("div",{staticClass:"tip-container"},[t._v(" "+t._s(t.activityStartDate)+" 开始准时开抢！ ")]),n("div",{staticClass:"rulesBg"},[n("div",{staticClass:"titleText"},[t._v("使用规则")]),n("div",{staticClass:"contentTextElse"},t._l(t.detail.useRule,(function(e,o){return n("p",{key:o},[t._v(" "+t._s("2"===t.detail.couponFrom?o+1+"、":"")+t._s(e)+t._s("2"===t.detail.couponFrom?"。":"")+" ")])})),0)]),t.showAlert?n("common-alert",{attrs:{title:"请输入预约手机号",confirmText:"提交",cancelText:"放弃",showOnConfirm:!0},on:{onCancel:t.hideAlert,onConfirm:t.appointmentMobile}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.phone,expression:"phone"}],attrs:{type:"tel",maxlength:"11",placeholder:"请输入数字"},domProps:{value:t.phone},on:{input:function(e){e.target.composing||(t.phone=e.target.value)}}})]):t._e()],1)])],1)},a=[],i=n("6beb"),s=n("d354"),r=n("4191"),c=n("f121"),u=n("a73f"),l=n("25e9");function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){h(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function h(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var f=function(){return n.e("chunk-04a68a12").then(n.bind(null,"d68c"))},m={hasReceivePersonNum:0,identifyFlag:-1},g={name:"couponInfo",components:{commonAlert:f,Skeleton:u["a"],couponValueLabel:l["a"]},data:function(){return{isSkeletonLoading:!0,detail:{},redBg:"url(".concat(c["a"].HOST_PIC,"/banner/coupon.png)"),blueBg:"url(".concat(c["a"].HOST_PIC,"/banner/couponblue.png)"),showAlert:!1,activityStartDate:"",phone:""}},filters:{removeHHMMSS:function(t){return t.toString().split(" ")[0]}},computed:{isBigVal:function(){return this.detail.couponValue>1e3},couponIcon:function(){var t={ORDER:"".concat(this.$cdnImageUrl,"/shop/icon-coupon-card.png"),SCENE:"".concat(this.$cdnImageUrl,"/shop/icon-coupon-scene.png"),SHOP:"".concat(this.$cdnImageUrl,"/shop/icon-coupon-shop.png")};return t},iconSrc:function(){var t=this.detail.couponUseType;return this.detail.applyType&&(t="SCENE"),this.couponIcon[t]||t}},mounted:function(){document.title="优惠券详情",this.getManageInfo(),this.getCouponDetail()},methods:{getManageInfo:function(){Object(s["g"])({},!0).then((function(t){var e=t.data;console.log("个人信息:",e),e.success&&e.data&&(m.identifyFlag=e.data.identifyFlag)}))},getCouponDetail:function(){var t=this,e=this.$route.query.activityCode,n=this.$route.query.couponTemplateCode,o=this.$route.query.couponCode,a=this.$route.query.sourceChannel,s=this.$route.query.platformChannel,c=o?{couponCode:o,activityCode:e,couponTemplateCode:n,sourceChannel:a,platformChannel:s}:{activityCode:e,couponTemplateCode:n,sourceChannel:a,platformChannel:s};i["a"].getCouponDetail(c).then((function(e){if(e.data.success){t.isSkeletonLoading=!1;var n=e.data.data;if("1"===n.couponFrom){var o=n.useRule.replace(/\[|]/g,"").replace(/"/g,"");n.useRule=o.split(",")}else{var a=[],i=JSON.stringify(n.useRule).split("。");i.map((function(t){t&&a.push(t)})),n.useRule=a}t.detail=n,m.hasReceivePersonNum=n.reQuliaty&&n.reQuliaty,t.activityStartDate=t.detail&&n.activityStartTime&&r["a"].formatFullDate(new Date(1e3*e.data.data.activityStartTime))}else t.detail=null}))["catch"]((function(){t.detail=null}))},getCoupon:function(){var t=this;if(!this.$store.getters.getLoginStatus)return this.$store.dispatch("feedback",this.$route.path),void this.$store.dispatch("doLogin");var e=this.$store.getters["getlocationInfo"].townshipId,n=this.$route.query.activityCode,o=this.$route.query.couponTemplateCode,a=this.$route.query.couponCode,s=this.$route.query.sourceChannel,r=this.$route.query.platformChannel,c=a?{couponCode:a,activityCode:n,couponTemplateCode:o,sourceChannel:s,platformChannel:r}:{activityCode:n,couponTemplateCode:o,sourceChannel:s,platformChannel:r};i["a"].getCoupon(d(d({},c),{},{streetId:e})).then((function(e){e.data.success?(t.$toast("领取成功"),t.detail.displayType="2",m.hasReceivePersonNum=e.data.data.hasReceivePersonNum,t.showRNTip()):t.$toast(e.data.message)}))},useCoupon:function(t){this.showRNTip()||this.$router.push("/usablecouponlist?activityCode=".concat(this.detail.activityCode,"&couponTemplateCode=").concat(this.$route.query.couponTemplateCode,"&couponType=").concat(t.couponType,"&sourceChannel=").concat(this.$route.query.sourceChannel,"&platformChannel=").concat(this.$route.query.platformChannel||""))},showRNTip:function(){if(this.$util.isSgRn()&&0===m.identifyFlag){var t=this.$route.query.activityCode,e=this.$route.query.couponTemplateCode,n=this.$route.query.couponCode,o=this.$route.query.sourceChannel,a=this.$route.query.platformChannel,i=n?{couponCode:n,activityCode:t,couponTemplateCode:e,sourceChannel:o,platformChannel:a}:{activityCode:t,couponTemplateCode:e,sourceChannel:o,platformChannel:a};return window.postMessage(JSON.stringify({type:"showCouponTip",data:d({},i)})),!0}return!1},appointmentTip:function(){this.showAlert=!0},hideAlert:function(){this.showAlert=!1},appointmentMobile:function(){var t=this;this.phone.length<11?this.$toast("请输入正确的手机号"):(this.showAlert=!1,i["a"].setCouponRemind({phone:this.phone,couponId:this.detail.id}).then((function(e){e.data.success&&(t.$toast("预约成功！"),t.getCouponDetail())})))}}},C=g,y=(n("06ea"),n("2877")),v=Object(y["a"])(C,o,a,!1,null,"3d9236d8",null);e["default"]=v.exports},"347c":function(t,e,n){},"4ff6":function(t,e,n){"use strict";n("0664")},"6beb":function(t,e,n){"use strict";var o=n("bbc2"),a=n("1c03"),i=function(t){return a["a"].get(o["a"].GET_CUSTOM_PAGE,{params:t})},s=function(t){return a["a"].get(o["a"].GET_ACTIVITY_PAGE,{params:t})},r=function(t){return a["a"].get(o["a"].GET_COUPON_DETAIL,{params:t})},c=function(t){return a["a"].get(o["a"].REMIND_COUPONS_LIST,{params:t})},u=function(t){return a["a"].get(o["a"].receiveCoupon,{params:t})},l=function(t){return a["a"].get(o["a"].isWdHost,{params:t})};e["a"]={getCustomPage:i,getActivityPage:s,getCouponDetail:r,setCouponRemind:c,getCoupon:u,isWdHost:l}},70463:function(t,e,n){},"80cc":function(t,e,n){"use strict";n("347c")},a73f:function(t,e,n){"use strict";var o=function(t,e){var n=e._c;return e.props.nums>0?n("div",{staticClass:"m-skeleton",style:{"z-index":e.props.zIndex||0}},[n("div",{style:{background:e.props.bgColor,height:e.props.fheight}}),e._l(e.props.nums-1,(function(t){return n("div",{key:t,style:{background:e.props.bgColor,height:e.props.iheight}})}))],2):e._e()},a=[],i=(n("80cc"),n("2877")),s={},r=Object(i["a"])(s,o,a,!0,null,null,null);e["a"]=r.exports},d354:function(t,e,n){"use strict";n.d(e,"g",(function(){return i})),n.d(e,"d",(function(){return s})),n.d(e,"f",(function(){return r})),n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return l})),n.d(e,"e",(function(){return p}));var o=n("1c03"),a=n("bbc2"),i=function(t,e){return o["a"].request({url:a["a"].myManage,method:"get",params:{_t:Date.now()},noLogin:e})},s=function(t){return o["a"].request({url:a["a"].getOrderCount,method:"get",params:{chId:60}})},r=function(t){return o["a"].request({url:a["a"].wallet,method:"get",params:{}})},c=function(t){return o["a"].request({url:a["a"].checkBindByType,method:"get",params:t})},u=function(t){return o["a"].request({url:a["a"].getComminsionSumInfo,method:"POST",data:t,headers:{"Content-Type":"application/json"}})},l=function(t){return o["a"].request({url:a["a"].getGoodsAmountList,method:"POST",data:t,headers:{"Content-Type":"application/json"}})},p=function(t){return o["a"].request({url:a["a"].getServiceCharge,method:"get",params:t})}}}]);
//# sourceMappingURL=chunk-32e8fd38.fc860876.js.map