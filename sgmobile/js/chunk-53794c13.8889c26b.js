(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-53794c13"],{"1c51":function(t,e,a){"use strict";a("24de")},"24de":function(t,e,a){},"347c":function(t,e,a){},6228:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{background:"white",height:"100%"}},[t.isSkeletonLoading?a("skeleton",{attrs:{nums:4,iheight:".4rem"}}):a("div",[a("div",{staticClass:"container"},[t.detail?a("div",{staticClass:"coupon-container"},[a("div",{staticClass:"content-wrapper"},[a("div",{staticClass:"value-wrapper"},[a("span",{staticClass:"val-icon"},[t._v("￥")]),a("span",{staticClass:"val-num",class:{bigVal:t.isBigVal}},[t._v(t._s(t.detail.couponValue))])]),a("div",{staticClass:"info-wrapper"},[a("div",{staticClass:"info"},[a("p",{staticClass:"info-text"},["PRODUCT"===t.couponData.scope?a("span",{staticClass:"singleItem"},[t._v("单品")]):t._e(),"ORDER"===t.couponData.scope?a("span",{staticClass:"singleItem"},[t._v("订单")]):t._e(),t._v(" "+t._s(t.couponData.description)+" ")]),a("p",{staticClass:"info-text"},[t._v(t._s(t.couponData.couponTemplateName))]),t.couponData.startTime?a("p",{staticClass:"info-text"},[t._v(t._s(t._f("formatDateEndOfDay")(t.couponData.startTime))+" — "+t._s(t._f("formatDateEndOfDay")(t.couponData.endTime)))]):a("p",{staticClass:"info-text"},[t._v(t._s(t.couponData.validityPeriod))])]),a("div",{staticClass:"receive"},["1"!==t.detail.displayType?a("div",{staticClass:"percent-container"}):t._e(),"1"===t.detail.displayType?a("div",{staticClass:"not-received"},[a("span",{staticClass:"receive-btn",on:{click:function(e){return e.stopPropagation(),t.getCoupon()}}},[t._v("立即领取")])]):"2"===t.detail.displayType?a("div",{staticClass:"received"},[a("span",{staticClass:"receive-disabled",on:{click:function(e){return e.stopPropagation(),t.useCoupon.apply(null,arguments)}}},[t._v("立即使用")]),a("img",{staticClass:"received-img",attrs:{src:t.$cdnImageUrl+"/shop/coupon-received.png"}})]):"3"===t.detail.displayType?a("div",{staticClass:"received"},[a("span",{staticClass:"receive-disabled",on:{click:function(e){return e.stopPropagation(),t.appointmentTip.apply(null,arguments)}}},[t._v("预约")])]):"4"===t.detail.displayType?a("div",{staticClass:"received"},[a("span",{staticClass:"receive-disabled"},[t._v("已设提醒")])]):"5"===t.detail.displayType?a("div",{staticClass:"received"},[a("span",{staticClass:"receive-disabled"},[t._v("已抢光")])]):a("div",{staticClass:"sold-out"},[a("img",{staticClass:"sold-out-img",attrs:{src:t.$cdnImageUrl+"/shop/coupon-sold-out.png"}})])])])]),a("img",{staticClass:"type-icon",attrs:{src:t.iconSrc,alt:""}}),a("img",{staticClass:"new-coupon-bg",attrs:{src:t.$cdnImageUrl+"/shop/yhq-new-coupon-bg.png"}})]):t._e(),!t.detail||"3"!==t.detail.displayType&&"4"!==t.detail.displayType?t._e():a("div",{staticClass:"tip-container"},[t._v(" "+t._s(t.activityStartDate)+" 开始准时开抢！ ")]),a("div",{staticClass:"rulesBg"},[a("div",{staticClass:"titleText"},[t._v("使用规则")]),a("div",{staticClass:"contentTextElse"},t._l(t.detail.useRule,(function(e,n){return a("p",{key:n},[t._v(" "+t._s("2"===t.detail.couponFrom?n+1+"、":"")+t._s(e)+t._s("2"===t.detail.couponFrom?"。":"")+" ")])})),0)]),t.showAlert?a("common-alert",{attrs:{title:"请输入预约手机号",confirmText:"提交",cancelText:"放弃",showOnConfirm:!0},on:{onCancel:t.hideAlert,onConfirm:t.appointmentMobile}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.phone,expression:"phone"}],attrs:{type:"tel",maxlength:"11",placeholder:"请输入数字"},domProps:{value:t.phone},on:{input:function(e){e.target.composing||(t.phone=e.target.value)}}})]):t._e()],1)])],1)},o=[],i=a("6beb"),s=a("d354"),c=a("4191"),r=a("f121"),u=a("a73f"),p=function(){return a.e("chunk-04a68a12").then(a.bind(null,"d68c"))},l={name:"couponDetail",components:{commonAlert:p,Skeleton:u["a"]},data:function(){return{isSkeletonLoading:!0,detail:{},redBg:"url(".concat(r["a"].HOST_PIC,"/banner/coupon.png)"),blueBg:"url(".concat(r["a"].HOST_PIC,"/banner/couponblue.png)"),dotNum:window.innerWidth/12|0,showAlert:!1,activityStartDate:"",phone:"",hasReceivePersonNum:0,identifyFlag:-1}},filters:{removeHHMMSS:function(t){return t.toString().split(" ")[0]}},computed:{couponData:function(){return this.detail},isBigVal:function(){return this.detail.couponValue>1e3},couponIcon:function(){var t={ORDER:"".concat(this.$cdnImageUrl,"/shop/icon-coupon-card.png"),SCENE:"".concat(this.$cdnImageUrl,"/shop/icon-coupon-scene.png"),SHOP:"".concat(this.$cdnImageUrl,"/shop/icon-coupon-shop.png")};return t},iconSrc:function(){var t=this.detail.couponUseType;return this.detail.applyType&&(t="SCENE"),this.couponIcon[t]||t}},mounted:function(){document.title="优惠券详情",this.getManageInfo(),this.getCouponDetail()},methods:{getManageInfo:function(){var t=this;Object(s["g"])().then((function(e){var a=e.data;console.log("个人信息:",a),a.success&&a.data&&(t.identifyFlag=a.data.identifyFlag)}))},getCouponDetail:function(){var t=this;i["a"].getCouponDetail({activityCode:this.$route.params.activityCode,couponTemplateCode:this.$route.params.couponTemplateCode,sourceChannel:this.$route.params.sourceChannel}).then((function(e){if(e.data.success){t.isSkeletonLoading=!1;var a=e.data.data;if("1"===a.couponFrom){var n=a.useRule.replace(/\[|]/g,"").replace(/"/g,"");a.useRule=n.split(",")}else{var o=[],i=JSON.stringify(a.useRule).split("。");i.map((function(t){t&&o.push(t)})),a.useRule=o}t.detail=a,t.hasReceivePersonNum=a.reQuliaty&&a.reQuliaty,t.activityStartDate=t.detail&&a.activityStartTime&&c["a"].formatFullDate(new Date(1e3*e.data.data.activityStartTime))}else t.detail=null}))["catch"]((function(){t.detail=null}))},getCoupon:function(){var t=this;if(!this.$store.getters.getLoginStatus)return this.$store.dispatch("feedback",this.$route.path),void this.$store.dispatch("doLogin");var e=this.$store.getters["getlocationInfo"].townshipId,a=this.couponCode?{couponCode:this.couponCode,activityCode:this.activityCode,couponTemplateCode:this.couponTemplateCode,sourceChannel:this.sourceChannel,streetId:e}:{activityCode:this.activityCode,couponTemplateCode:this.couponTemplateCode,sourceChannel:this.sourceChannel,streetId:e};i["a"].getCoupon(a).then((function(e){t.$toast(e.data.message),e.data.success&&(t.showRNTip(),t.getCouponDetail())}))},useCoupon:function(t){this.showRNTip()||this.$router.push("/usablecouponlist?activityCode=".concat(this.detail.activityCode,"&couponTemplateCode=").concat(this.$route.params.couponTemplateCode,"&couponType=").concat(t.couponType))},showRNTip:function(){return!(!this.$util.isSgRn()||0!==this.identifyFlag)&&(window.postMessage(JSON.stringify({type:"showCouponTip",data:{couponId:this.detail.id,couponFrom:this.$route.params.from,couponType:this.detail.couponType}})),!0)},appointmentTip:function(){this.showAlert=!0},hideAlert:function(){this.showAlert=!1},appointmentMobile:function(){var t=this;this.phone.length<11?this.$toast("请输入正确的手机号"):(this.showAlert=!1,i["a"].setCouponRemind({phone:this.phone,couponId:this.detail.id}).then((function(e){e.data.success&&(t.$toast("预约成功！"),t.getCouponDetail())})))}}},d=l,h=(a("1c51"),a("2877")),g=Object(h["a"])(d,n,o,!1,null,"4c57a886",null);e["default"]=g.exports},"6beb":function(t,e,a){"use strict";var n=a("bbc2"),o=a("1c03"),i=function(t){return o["a"].get(n["a"].GET_CUSTOM_PAGE,{params:t})},s=function(t){return o["a"].get(n["a"].GET_ACTIVITY_PAGE,{params:t})},c=function(t){return o["a"].get(n["a"].GET_COUPON_DETAIL,{params:t})},r=function(t){return o["a"].get(n["a"].REMIND_COUPONS_LIST,{params:t})},u=function(t){return o["a"].get(n["a"].receiveCoupon,{params:t})},p=function(t){return o["a"].get(n["a"].isWdHost,{params:t})};e["a"]={getCustomPage:i,getActivityPage:s,getCouponDetail:c,setCouponRemind:r,getCoupon:u,isWdHost:p}},"80cc":function(t,e,a){"use strict";a("347c")},a73f:function(t,e,a){"use strict";var n=function(t,e){var a=e._c;return e.props.nums>0?a("div",{staticClass:"m-skeleton",style:{"z-index":e.props.zIndex||0}},[a("div",{style:{background:e.props.bgColor,height:e.props.fheight}}),e._l(e.props.nums-1,(function(t){return a("div",{key:t,style:{background:e.props.bgColor,height:e.props.iheight}})}))],2):e._e()},o=[],i=(a("80cc"),a("2877")),s={},c=Object(i["a"])(s,n,o,!0,null,null,null);e["a"]=c.exports},d354:function(t,e,a){"use strict";a.d(e,"g",(function(){return i})),a.d(e,"d",(function(){return s})),a.d(e,"f",(function(){return c})),a.d(e,"a",(function(){return r})),a.d(e,"b",(function(){return u})),a.d(e,"c",(function(){return p})),a.d(e,"e",(function(){return l}));var n=a("1c03"),o=a("bbc2"),i=function(t,e){return n["a"].request({url:o["a"].myManage,method:"get",params:{_t:Date.now()},noLogin:e})},s=function(t){return n["a"].request({url:o["a"].getOrderCount,method:"get",params:{chId:60}})},c=function(t){return n["a"].request({url:o["a"].wallet,method:"get",params:{}})},r=function(t){return n["a"].request({url:o["a"].checkBindByType,method:"get",params:t})},u=function(t){return n["a"].request({url:o["a"].getComminsionSumInfo,method:"POST",data:t,headers:{"Content-Type":"application/json"}})},p=function(t){return n["a"].request({url:o["a"].getGoodsAmountList,method:"POST",data:t,headers:{"Content-Type":"application/json"}})},l=function(t){return n["a"].request({url:o["a"].getServiceCharge,method:"get",params:t})}}}]);
//# sourceMappingURL=chunk-53794c13.8889c26b.js.map