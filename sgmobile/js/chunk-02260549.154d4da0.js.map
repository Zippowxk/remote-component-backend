{"version":3,"sources":["webpack:///./src/views/goods/detail/components/recommendation.vue?6d5c","webpack:///src/views/goods/detail/components/recommendation.vue","webpack:///./src/views/goods/detail/components/recommendation.vue?abb9","webpack:///./src/views/goods/detail/components/recommendation.vue","webpack:///./src/views/goods/detail/components/recommendation.vue?9dbe"],"names":["render","_vm","this","_h","$createElement","_c","_self","pageCount","staticClass","_m","attrs","on","onChange","scopedSlots","_u","key","fn","dataCount","style","indicatorLeft","proxy","_l","c","pageData","class","i","index","sku","$event","toDetail","indexImageUrl","_v","_s","productFullName","_f","finalPrice","_e","staticRenderFns","props","productId","type","Number","data","pageSize","currentIndex","computed","location","$store","getters","filters","formatPriceInt","v","split","formatPriceFloat","created","getData","methods","channel","pageNo","street","shareId","state","res","success","getLocalDataCount","forEach","count","length","$router","push","path","query","item","component"],"mappings":"uHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAQF,EAAIM,UAAU,EAAGF,EAAG,MAAM,CAACG,YAAY,aAAa,CAACP,EAAIQ,GAAG,GAAGJ,EAAG,MAAM,CAACG,YAAY,kBAAkB,CAACH,EAAG,YAAY,CAACG,YAAY,SAASE,MAAM,CAAC,MAAO,GAAOC,GAAG,CAAC,OAASV,EAAIW,UAAUC,YAAYZ,EAAIa,GAAG,CAAC,CAACC,IAAI,YAAYC,GAAG,WAAW,MAAO,CAAEf,EAAIgB,UAAU,EAAGZ,EAAG,MAAM,CAACG,YAAY,oBAAoB,CAACH,EAAG,OAAO,CAACG,YAAY,YAAYU,MAAM,CAAE,MAAS,IAAKjB,EAAIM,UAAW,MAAM,cAAcN,EAAIkB,mBAAoBd,EAAG,UAAUe,OAAM,IAAO,MAAK,EAAM,aAAanB,EAAIoB,GAAIpB,EAAa,WAAE,SAASqB,GAAG,OAAOjB,EAAG,iBAAiB,CAACU,IAAI,OAAOO,GAAG,CAAErB,EAAIsB,SAASD,EAAI,GAAIjB,EAAG,MAAM,CAACG,YAAY,OAAOgB,MAAM,CAAC,YAAavB,EAAIgB,WAAW,IAAIhB,EAAIoB,GAAIpB,EAAIsB,SAASD,EAAI,IAAI,SAASG,EAAEC,GAAO,OAAOrB,EAAG,MAAM,CAACU,IAAIU,EAAEE,IAAInB,YAAY,OAAOgB,MAAM,CAAC,YAAuB,IAAVE,GAAyB,IAAVA,GAAaf,GAAG,CAAC,MAAQ,SAASiB,GAAQ,OAAO3B,EAAI4B,SAASJ,MAAM,CAACpB,EAAG,MAAM,CAACG,YAAY,YAAY,CAACH,EAAG,MAAM,CAACK,MAAM,CAAC,IAAMe,EAAEK,mBAAmBzB,EAAG,MAAM,CAACG,YAAY,cAAc,CAACP,EAAI8B,GAAG,IAAI9B,EAAI+B,GAAGP,EAAEQ,iBAAiB,OAAO5B,EAAG,MAAM,CAACG,YAAY,cAAc,CAACH,EAAG,OAAO,CAACG,YAAY,QAAQ,CAACP,EAAI8B,GAAG,OAAO1B,EAAG,OAAO,CAACG,YAAY,OAAO,CAACP,EAAI8B,GAAG9B,EAAI+B,GAAG/B,EAAIiC,GAAG,iBAAPjC,CAAyBA,EAAIiC,GAAG,cAAPjC,CAAsBwB,EAAEU,iBAAiB9B,EAAG,OAAO,CAACG,YAAY,SAAS,CAACP,EAAI8B,GAAG9B,EAAI+B,GAAG/B,EAAIiC,GAAG,mBAAPjC,CAA2BA,EAAIiC,GAAG,cAAPjC,CAAsBwB,EAAEU,wBAAuB,GAAGlC,EAAImC,UAAS,IAAI,KAAKnC,EAAImC,MAC75CC,EAAkB,CAAC,WAAa,IAAIpC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACG,YAAY,UAAU,CAACH,EAAG,OAAO,CAACG,YAAY,SAAS,CAACP,EAAI8B,GAAG,c,YCiCnL,GACEO,MAAO,CACLC,UAAW,CACTC,KAAMC,SAGVC,KANF,WAOI,MAAO,CACLnC,UAAW,EACXU,UAAW,EACX0B,SAAU,EACVpB,SAAU,GACVqB,aAAc,IAGlBC,SAAU,CACR1B,cADJ,WAEM,IAAN,qBACM,OAAO,KAAb,sBAEI2B,SALJ,WAMM,OAAO5C,KAAK6C,OAAOC,QAAQ,qBAG/BC,QAAS,CACPC,eADJ,SACA,GACM,OAAOC,EAAEC,MAAM,KAAK,GAAK,KAE3BC,iBAJJ,SAIA,GACM,OAAOF,EAAEC,MAAM,KAAK,KAGxBE,QAhCF,WAiCIpD,KAAKqD,QAAQrD,KAAK0C,aAAe,IAEnCY,QAAS,CACP5C,SADJ,SACA,GACMV,KAAK0C,aAAelB,EAIhBxB,KAAKqB,SAASG,KAAWxB,KAAKqB,SAASG,EAAQ,IAAMA,EAAQxB,KAAKK,UAAY,EAChFL,KAAKqD,QAAQrD,KAAK0C,aAAe,GACzC,kBACQ1C,KAAKqD,QAAQrD,KAAK0C,aAAe,IAMrCW,QAfJ,SAeA,gBACA,GACQhB,UAAWrC,KAAKqC,UAChBkB,QAAS,IACTd,SAAUzC,KAAKyC,SACfe,OAAQhC,EACRiC,QAAR,8DACQC,QAAS1D,KAAK6C,OAAOc,MAAMD,SAAW,IAExC,OAAN,QAAM,CAAN,qBACYE,EAAIpB,KAAKqB,UAEX,EAAV,4BACU,EAAV,mCAGU,EAAV,kCAKe,EAAf,sEACY,EAAZ,kBAQIC,kBA7CJ,WA8CM,IAAN,IAIM,OAHA9D,KAAKqB,SAAS0C,SAAQ,SAA5B,GACQC,GAASJ,EAAIK,UAERD,GAKTrC,SAvDJ,SAuDA,GACM3B,KAAKkE,QAAQC,KAAK,CAChBC,KAAM,cACNC,MAAO,CACLhC,UAAWiC,EAAKjC,gBChI2W,I,wBCQjYkC,EAAY,eACd,EACAzE,EACAqC,GACA,EACA,KACA,WACA,MAIa,aAAAoC,E,2CCnBf,W","file":"js/chunk-02260549.154d4da0.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.pageCount>0)?_c('div',{staticClass:\"container\"},[_vm._m(0),_c('div',{staticClass:\"swiper-content\"},[_c('van-swipe',{staticClass:\"swiper\",attrs:{\"loop\":false},on:{\"change\":_vm.onChange},scopedSlots:_vm._u([{key:\"indicator\",fn:function(){return [(_vm.dataCount>6)?_c('div',{staticClass:\"custom-indicator\"},[_c('span',{staticClass:\"index-btn\",style:({'width':(0.64/_vm.pageCount)+'rem','margin-left':_vm.indicatorLeft})})]):_c('span')]},proxy:true}],null,false,1929860286)},_vm._l((_vm.pageCount),function(c){return _c('van-swipe-item',{key:'page'+c},[(_vm.pageData[c - 1])?_c('div',{staticClass:\"page\",class:{'harf-page': _vm.dataCount<=3}},_vm._l((_vm.pageData[c - 1]),function(i,index){return _c('div',{key:i.sku,staticClass:\"item\",class:{'lr-margin': index === 1 || index === 4},on:{\"click\":function($event){return _vm.toDetail(i)}}},[_c('div',{staticClass:\"img-area\"},[_c('img',{attrs:{\"src\":i.indexImageUrl}})]),_c('div',{staticClass:\"title-area\"},[_vm._v(\" \"+_vm._s(i.productFullName)+\" \")]),_c('div',{staticClass:\"price-area\"},[_c('span',{staticClass:\"yuan\"},[_vm._v(\"¥\")]),_c('span',{staticClass:\"int\"},[_vm._v(_vm._s(_vm._f(\"formatPriceInt\")(_vm._f(\"formatPrice\")(i.finalPrice))))]),_c('span',{staticClass:\"float\"},[_vm._v(_vm._s(_vm._f(\"formatPriceFloat\")(_vm._f(\"formatPrice\")(i.finalPrice))))])])])}),0):_vm._e()])}),1)],1)]):_vm._e()}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"header\"},[_c('span',{staticClass:\"title\"},[_vm._v(\"商品推荐\")])])}]\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"container\" v-if=\"pageCount>0\">\n        <div class=\"header\"><span class=\"title\">商品推荐</span></div>\n        <div class=\"swiper-content\">\n            <van-swipe class=\"swiper\" :loop=\"false\" @change=\"onChange\">\n                <!-- 按页数预渲染指定页数 -->\n                <van-swipe-item v-for=\"c in pageCount\" :key=\"'page'+c\">\n                    <!-- 当前页数据存在时渲染 -->\n                    <div class=\"page\" :class=\"{'harf-page': dataCount<=3}\" v-if=\"pageData[c - 1]\">\n                        <div class=\"item\" v-for=\"(i,index) in pageData[c - 1]\" :key=\"i.sku\" @click=\"toDetail(i)\" :class=\"{'lr-margin': index === 1 || index === 4}\">\n                            <div class=\"img-area\"><img :src=\"i.indexImageUrl\"></div>\n                            <div class=\"title-area\"> {{i.productFullName}} </div>\n                            <div class=\"price-area\">\n                                <span class=\"yuan\">¥</span>\n                                <span class=\"int\">{{i.finalPrice |formatPrice | formatPriceInt}}</span>\n                                <span class=\"float\">{{i.finalPrice |formatPrice | formatPriceFloat}}</span>\n                                </div>\n                        </div>\n                    </div>\n                </van-swipe-item>\n                <template #indicator>\n                    <!-- 总页数只有一页时不展示 -->\n                    <div v-if=\"dataCount>6\" class=\"custom-indicator\"><span class=\"index-btn\" :style=\"{'width':(0.64/pageCount)+'rem','margin-left':indicatorLeft}\"></span></div>\n                    <span v-else></span>\n                </template>\n            </van-swipe>\n        </div>\n    </div>\n</template>\n\n<script>\nimport {\n  getRelationProductList,\n} from '@/http/service/goods'\nexport default {\n  props: {\n    productId: {\n      type: Number,\n    },\n  },\n  data() {\n    return {\n      pageCount: 0, // Math.ceil(总记录数/6)\n      dataCount: 0, // 总记录数\n      pageSize: 6, // 每页记录数\n      pageData: [], // 分页数据\n      currentIndex: 0\n    }\n  },\n  computed: {\n    indicatorLeft() {\n      let width = 0.64 / this.pageCount\n      return (this.currentIndex * width) + 'rem'\n    },\n    location() {\n      return this.$store.getters['getlocationInfo']\n    },\n  },\n  filters: {\n    formatPriceInt(v) {\n      return v.split('.')[0] + '.';\n    },\n    formatPriceFloat(v) {\n      return v.split('.')[1];\n    },\n  },\n  created() {\n    this.getData(this.currentIndex + 1)\n  },\n  methods: {\n    onChange(index) {\n      this.currentIndex = index\n      // 当前页数据已存在，下一页数据不存在 ==> 预加载下一页\n      // 当前页数据不存在 ==> 加载当前页数据\n      // 其他情况 不调用接口\n      if (this.pageData[index] && !this.pageData[index + 1] && index < this.pageCount - 1) {\n        this.getData(this.currentIndex + 2)\n      } else if (!this.pageData[index]) {\n        this.getData(this.currentIndex + 1)\n      }\n    },\n    /**\n     * @description 加载推荐商品数据\n    */\n    getData(index) {\n      let param = {\n        productId: this.productId,\n        channel: '1',\n        pageSize: this.pageSize,\n        pageNo: index,\n        street: this.location?.townshipId || '',\n        shareId: this.$store.state.shareId || '',\n      }\n      getRelationProductList(param).then(res => {\n        if (res.data.success) {\n          // 计算页数\n          this.dataCount = res.data.totalCount\n          this.pageCount = Math.ceil(this.dataCount / 6)\n\n          // 分页数据\n          this.$set(this.pageData, index - 1, res.data.data)\n          //   this.pageData[index - 1] = res.data.data\n          //   this.$forceUpdate()\n\n          // 如果下一页数据未加载，预加载下一页数据\n          if (!this.pageData[index] && this.getLocalDataCount() < this.dataCount && index === this.currentIndex + 1) {\n            this.getData(index + 1)\n          }\n        }\n      })\n    },\n    /**\n     * 本地已加载数据量\n    */\n    getLocalDataCount() {\n      let count = 0\n      this.pageData.forEach(res => {\n        count += res.length\n      })\n      return count\n    },\n    /**\n     * @description 跳转单品页\n    */\n    toDetail(item) {\n      this.$router.push({\n        path: 'goodsDetail',\n        query: {\n          productId: item.productId\n        },\n      })\n    }\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.container{\n    background-color: #ffffff;\n    border-radius: .24rem;\n    // padding: .2rem .32rem;\n    padding: .2rem 0;\n    margin-top: .24rem;\n    .header{\n        display: flex;\n        justify-content: flex-start;\n        align-items: center;\n        margin-bottom: .1rem;\n        padding-left: .32rem;\n        .title{\n            font-size: .28rem;\n            font-family: PingFangSC, PingFangSC-Medium;\n            font-weight: 500;\n            color: #333333;\n            line-height: .4rem;\n            margin-left: .12rem;\n        }\n        &::before{\n            content: '';\n            width: .06rem;\n            height: .26rem;\n            background: linear-gradient(180deg,#37a4ff, #186eff);\n            border-radius: .04rem;\n        }\n    }\n    .swiper-content{\n        .swiper{\n            .page{\n                height: 375px;\n                width: 100%;\n                display: flex;\n                justify-content: flex-start;\n                // justify-content: space-between;\n                flex-wrap: wrap;\n                padding-left: .32rem;\n                .item{\n                    // flex: 1;\n                    display: flex;\n                    width: 2.18rem;\n                    flex-direction: column;\n                    justify-content: flex-start;\n                    .img-area{\n                        width: 2.18rem;\n                        height: 2.18rem;\n                        background: #ffffff;\n                        border-radius: .16rem;\n                        overflow: hidden;\n                        margin-bottom: .16rem;\n                        img{\n                            // max-width: 100%;\n                            height: 100%;\n                            width: 100%;\n                        }\n                    }\n                    .title-area{\n                        font-size: .24rem;\n                        font-family: PingFangSC, PingFangSC-Regular;\n                        font-weight: 400;\n                        color: #333333;\n                        line-height: .34rem;\n                        line-clamp: 2;\n                        -webkit-line-clamp: 2;\n                        -webkit-box-orient: vertical;\n                        display: -webkit-box;\n                        white-space:ellipsis;\n                        overflow: hidden;\n                        margin-bottom: .1rem;\n                    }\n                    .price-area{\n                        font-family: DINAlternate, DINAlternate-Bold;\n                        font-weight: 700;\n                        color: #fd3434;\n                        line-height: .32rem;\n                        margin-bottom: .32rem;\n                        .yuan{\n                            font-size: .24rem;\n                        }\n                        .int{\n                            font-size: .34rem;\n                        }\n                        .float{\n                            font-size: .24rem;\n                        }\n                    }\n                }\n            }\n            .custom-indicator{\n                width: .64rem;\n                height: .06rem;\n                background: #dddddd;\n                border-radius: .04rem;\n                margin: 0 auto;\n                display: flex;\n                .index-btn{\n                    height: 100%;\n                    background: #2878ff;\n                    border-radius: .04rem;\n                    display: inline-block;\n                }\n            }\n        }\n\n    }\n}\n.lr-margin{\n    margin: 0 .16rem;\n}\n.container .swiper-content .swiper .page.harf-page{\n    height: 3.75rem;\n}\n</style>\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./recommendation.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./recommendation.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./recommendation.vue?vue&type=template&id=67dff8d1&scoped=true&\"\nimport script from \"./recommendation.vue?vue&type=script&lang=js&\"\nexport * from \"./recommendation.vue?vue&type=script&lang=js&\"\nimport style0 from \"./recommendation.vue?vue&type=style&index=0&id=67dff8d1&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"67dff8d1\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../../../node_modules/@sg/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./recommendation.vue?vue&type=style&index=0&id=67dff8d1&lang=scss&scoped=true&\""],"sourceRoot":""}