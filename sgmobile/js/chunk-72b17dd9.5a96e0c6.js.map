{"version":3,"sources":["webpack:///./src/http/service/mine.js","webpack:///./src/components/picture-share/components/good-main-picture.vue?a244","webpack:///src/components/picture-share/components/good-main-picture.vue","webpack:///./src/components/picture-share/components/good-main-picture.vue?e889","webpack:///./src/components/picture-share/components/good-main-picture.vue"],"names":["myManageinfo","data","noLogin","http","request","url","myManage","method","params","Date","now","getOrderCount","chId","getWallet","wallet","checkBindByType","getComminsionSumInfo","headers","getGoodsAmountList","getServiceCharge","render","_vm","this","_h","$createElement","_c","_self","staticClass","class","unvisitable","mainPicture","ref","attrs","mainPictureBase64","_v","_s","mainProductName","priceInt","priceFloat","directives","name","rawName","value","expression","canvasSrc","_m","storeLogo","$store","state","userInfo","username","_e","staticRenderFns","components","props","actualPrice","isPartner","hasSubProduct","created","getIdentify","shareMessage","createQRCode","mdCode","spuList","length","productFullName","getProductInfo","mounted","beforeDestroy","methods","shareLinkFactory","mid","query","storeId","shareId","queryString","$nextTick","decodeURIComponent","size","getUrlBase64","canvas","document","createElement","ctx","getContext","img","Image","crossOrigin","src","onload","height","width","drawImage","dataURL","toDataURL","ext","callback","call","res","success","identifyFlag","includes","productId","channel","openId","sceneCode","$route","fkcode","swiperImgs","computed","mainPictureRandom","Math","floor","watch","component"],"mappings":"gHAAA,0QAQaA,EAAe,SAACC,EAAMC,GACjC,OAAOC,OAAKC,QAAQ,CAClBC,IAAKA,OAAIC,SACTC,OAAQ,MACRC,OAAQ,CAAE,GAAMC,KAAKC,OACrBR,aAISS,EAAgB,SAAAV,GAC3B,OAAOE,OAAKC,QAAQ,CAClBC,IAAKA,OAAIM,cACTJ,OAAQ,MACRC,OAAQ,CACNI,KAAM,OAMCC,EAAY,SAAAZ,GACvB,OAAOE,OAAKC,QAAQ,CAClBC,IAAKA,OAAIS,OACTP,OAAQ,MACRC,OAAQ,MAKCO,EAAkB,SAAAP,GAC7B,OAAOL,OAAKC,QAAQ,CAClBC,IAAKA,OAAIU,gBACTR,OAAQ,MACRC,YAKSQ,EAAuB,SAACf,GACnC,OAAOE,OAAKC,QAAQ,CAClBC,IAAKA,OAAIW,qBACTT,OAAQ,OACRN,OACAgB,QAAS,CACP,eAAgB,uBAMTC,EAAqB,SAACjB,GACjC,OAAOE,OAAKC,QAAQ,CAClBC,IAAKA,OAAIa,mBACTX,OAAQ,OACRN,OACAgB,QAAS,CACP,eAAgB,uBAMTE,EAAmB,SAACX,GAC/B,OAAOL,OAAKC,QAAQ,CAClBC,IAAKA,OAAIc,iBACTZ,OAAQ,MACRC,a,yCC1EJ,IAAIY,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,oBAAoBC,MAAM,CAACC,aAAaR,EAAIS,cAAc,CAACL,EAAG,MAAM,CAACE,YAAY,YAAY,CAACF,EAAG,MAAM,CAACM,IAAI,cAAcC,MAAM,CAAC,MAAQ,OAAO,OAAS,OAAO,IAAMX,EAAIY,kBAAkB,IAAM,QAAQR,EAAG,MAAM,CAACE,YAAY,aAAa,CAACF,EAAG,MAAM,CAACE,YAAY,cAAc,CAACF,EAAG,MAAM,CAACE,YAAY,QAAQ,CAACN,EAAIa,GAAGb,EAAIc,GAAGd,EAAIe,oBAAoBX,EAAG,MAAM,CAACE,YAAY,SAAS,CAACF,EAAG,OAAO,CAACE,YAAY,cAAc,CAACN,EAAIa,GAAG,OAAOT,EAAG,OAAO,CAACE,YAAY,aAAa,CAACN,EAAIa,GAAGb,EAAIc,GAAGd,EAAIgB,aAAaZ,EAAG,OAAO,CAACE,YAAY,eAAe,CAACN,EAAIa,GAAG,IAAIb,EAAIc,GAAGd,EAAIiB,eAAeb,EAAG,OAAO,CAACc,WAAW,CAAC,CAACC,KAAK,OAAOC,QAAQ,SAASC,MAAOrB,EAAiB,cAAEsB,WAAW,kBAAkBhB,YAAY,WAAW,CAACN,EAAIa,GAAG,WAAWT,EAAG,MAAM,CAACE,YAAY,cAAc,CAACF,EAAG,MAAM,CAACE,YAAY,KAAKK,MAAM,CAAC,IAAMX,EAAIuB,UAAU,IAAM,MAAMvB,EAAIwB,GAAG,GAAGpB,EAAG,MAAM,CAACE,YAAY,OAAOK,MAAM,CAAC,IAAMX,EAAIyB,UAAU,IAAM,QAAQrB,EAAG,MAAM,CAACE,YAAY,mBAAmB,CAAEN,EAAa,UAAEI,EAAG,MAAM,CAACE,YAAY,cAAc,CAACN,EAAIa,GAAG,IAAIb,EAAIc,GAAGd,EAAI0B,OAAOC,MAAMC,SAASC,UAAU,QAAQ7B,EAAI8B,YAC5pCC,EAAkB,CAAC,WAAa,IAAI/B,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,WAAW,CAACF,EAAG,MAAM,CAACE,YAAY,QAAQ,CAACF,EAAG,IAAI,CAACJ,EAAIa,GAAG,OAAOb,EAAIa,GAAG,cAAcT,EAAG,MAAM,CAACE,YAAY,QAAQ,CAACF,EAAG,IAAI,CAACJ,EAAIa,GAAG,OAAOb,EAAIa,GAAG,kB,gDCqClR,GACEmB,WAAY,GACZC,MAAO,CAAC,aACRrD,KAHF,WAII,MAAO,CACLsD,YAAa,EACbzB,YAAa,GACbM,gBAAiB,GACjBoB,WAAW,EACXZ,UAAW,GACXa,eAAe,EACfX,UAAW,GACXb,kBAAmB,KAGvByB,QAfF,WAgBIpC,KAAKwB,UAAY,GAArB,8FACIxB,KAAKqC,cACL,IAAJ,gEACQC,IACFtC,KAAKuC,aAAaD,EAAaE,QAAU,IACzCxC,KAAKiC,YAAcK,EAAaL,YAC5BK,EAAaG,QAAQC,SACvB1C,KAAKc,gBAAkBwB,EAAaG,QAAQ,GAAGE,gBAC/C3C,KAAK4C,eAAeN,MAI1BO,QA5BF,aA6BEC,cA7BF,aA8BEC,QAAS,CACPC,iBADJ,SACA,GACM,IAAN,uDACA,wBACA,8BACUC,IACFC,EAAMC,QAAUF,EAChBC,EAAME,QAAUH,GAEdT,IACFU,EAAMV,OAASA,GAEjB,IAAN,+BACM,OAAOzD,EAAMsE,GAEfd,aAfJ,SAeA,cAUA,2BACMvC,KAAKsD,WAAU,WACb,IAAR,kBACU3E,KAAM4E,mBAAmBxE,GACzByE,KAAM,MAER,EAAR,uCAGIC,aAlCJ,SAkCA,+GACUC,EAASC,SAASC,cAAc,UAChCC,EAAMH,EAAOI,WAAW,MACxBC,EAAM,IAAIC,MACdD,EAAIE,YAAc,YAClBF,EAAIG,IAAMnF,EACVgF,EAAII,OAAS,WACXT,EAAOU,OAAS,IAChBV,EAAOW,MAAQ,IACfR,EAAIS,UAAUP,EAAK,EAAG,EAAG,IAAK,KAC9B,IAAIQ,EAAUb,EAAOc,UAAU,SAAWC,EAAK,GAC/CC,EAASC,KAAK3E,KAAMuE,GACpBb,EAAS,OAIbrB,YAlDJ,WAkDA,WACM,OAAN,OAAM,GAAN,kBACYuC,EAAIC,SACFD,EAAIjG,KAAKA,KAAKmG,cAAgB,CAAC,GAAI,GAAI,IAAIC,SAASH,EAAIjG,KAAKA,KAAKmG,gBACpE,EAAZ,kBAKIlC,eA3DJ,SA2DA,cACM,OAAN,OAAM,CAAN,CACQoC,UAAW1C,EAAaG,QAAQ,GAAGuC,UACnCC,QAAS,GACTC,OAAQ,GACRC,UAAWnF,KAAKoF,OAAOlC,MAAMmC,QAAU,KAC/C,kBACYT,EAAIC,UACN,EAAV,gEACcD,EAAIjG,KAAK2G,YAAcV,EAAIjG,KAAK2G,WAAW5C,SAC7C,EAAZ,qFAEY,EAAZ,8CACc,EAAd,8BAQE6C,SAAU,CACRC,kBADJ,WAEM,OAAOxF,KAAKQ,YAAc,MAAhC,wBAEIO,SAJJ,WAKM,OAAO0E,KAAKC,MAAM1F,KAAKiC,cAEzBjB,WAPJ,WAQM,IAAN,oDACM,OAAO,IAGX2E,MAAO,IChKgX,I,YCOrXC,EAAY,eACd,EACA9F,EACAgC,GACA,EACA,KACA,KACA,MAIa,aAAA8D,E","file":"js/chunk-72b17dd9.5a96e0c6.js","sourcesContent":["/**\n * 分类模块\n * 导出至'@/http/service/category'\n */\nimport http from '../http'\nimport url from '../url'\n\n// 个人中心信息\nexport const myManageinfo = (data, noLogin) => {\n  return http.request({\n    url: url.myManage,\n    method: 'get',\n    params: { '_t': Date.now() },\n    noLogin\n  })\n}\n// 个人中心信息\nexport const getOrderCount = data => {\n  return http.request({\n    url: url.getOrderCount,\n    method: 'get',\n    params: {\n      chId: 60\n    }\n  })\n}\n\n// 个人中心 - 钱包信息\nexport const getWallet = data => {\n  return http.request({\n    url: url.wallet,\n    method: 'get',\n    params: {}\n  })\n}\n\n// 个人中心 - 营收模块 判断绑卡\nexport const checkBindByType = params => {\n  return http.request({\n    url: url.checkBindByType,\n    method: 'get',\n    params\n  })\n}\n\n// 个人中心 - 营收模块 信息汇总\nexport const getComminsionSumInfo = (data) => {\n  return http.request({\n    url: url.getComminsionSumInfo,\n    method: 'POST',\n    data,\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  })\n}\n\n// 个人中心 - 营收模块 账单列表\nexport const getGoodsAmountList = (data) => {\n  return http.request({\n    url: url.getGoodsAmountList,\n    method: 'POST',\n    data,\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  })\n}\n\n// 个人中心 - 营收模块 服务费信息\nexport const getServiceCharge = (params) => {\n  return http.request({\n    url: url.getServiceCharge,\n    method: 'get',\n    params\n  })\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"good-main-picture\",class:{unvisitable:!_vm.mainPicture}},[_c('div',{staticClass:\"good-pic\"},[_c('img',{ref:\"mainPicture\",attrs:{\"width\":\"100%\",\"height\":\"100%\",\"src\":_vm.mainPictureBase64,\"alt\":\"\"}})]),_c('div',{staticClass:\"good-info\"},[_c('div',{staticClass:\"title-line\"},[_c('div',{staticClass:\"name\"},[_vm._v(_vm._s(_vm.mainProductName))]),_c('div',{staticClass:\"price\"},[_c('span',{staticClass:\"price-icon\"},[_vm._v(\"￥\")]),_c('span',{staticClass:\"price-int\"},[_vm._v(_vm._s(_vm.priceInt))]),_c('span',{staticClass:\"price-float\"},[_vm._v(\".\"+_vm._s(_vm.priceFloat))]),_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.hasSubProduct),expression:\"hasSubProduct\"}],staticClass:\"has-sub\"},[_vm._v(\"起\")])])]),_c('div',{staticClass:\"qr-wrapper\"},[_c('img',{staticClass:\"qr\",attrs:{\"src\":_vm.canvasSrc,\"alt\":\"\"}}),_vm._m(0),_c('img',{staticClass:\"logo\",attrs:{\"src\":_vm.storeLogo,\"alt\":\"\"}})]),_c('div',{staticClass:\"share-name-line\"},[(_vm.isPartner)?_c('div',{staticClass:\"share-name\"},[_vm._v(\"由\"+_vm._s(_vm.$store.state.userInfo.username)+\"分享\")]):_vm._e()])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"qr-desc\"},[_c('div',{staticClass:\"line\"},[_c('b',[_vm._v(\"①\")]),_vm._v(\" 保存图片到相册\")]),_c('div',{staticClass:\"line\"},[_c('b',[_vm._v(\"②\")]),_vm._v(\" 微信扫一扫浏览\")])])}]\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"good-main-picture\" :class=\"{unvisitable:!mainPicture}\">\n    <div class=\"good-pic\">\n      <img  ref='mainPicture' width=\"100%\" height='100%' :src=\"mainPictureBase64\" alt=\"\" />\n    </div>\n    <div class=\"good-info\">\n      <div class=\"title-line\">\n        <div class=\"name\">{{mainProductName}}</div>\n        <div class=\"price\">\n          <span class=\"price-icon\">￥</span>\n          <span class=\"price-int\">{{priceInt}}</span>\n          <span class=\"price-float\">.{{priceFloat}}</span>\n          <span v-show=\"hasSubProduct\" class=\"has-sub\">起</span>\n        </div>\n      </div>\n      <div class=\"qr-wrapper\">\n        <img :src=\"canvasSrc\" alt=\"\" class=\"qr\">\n        <div class=\"qr-desc\">\n          <div class=\"line\"><b>①</b> 保存图片到相册</div>\n          <div class=\"line\"><b>②</b> 微信扫一扫浏览</div>\n        </div>\n        <img :src=\"storeLogo\" alt=\"\" class=\"logo\">\n      </div>\n      <div class=\"share-name-line\">\n        <div v-if=\"isPartner\" class=\"share-name\">由{{$store.state.userInfo.username}}分享</div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { qrcanvas } from 'qrcanvas'\n// import html2canvas from 'html2canvas'\n// import config from '@/config'\nimport utils from '@/utils/utils'\nimport { getProductBasicInfo } from '@/http/service/goods'\nimport { myManageinfo } from '@/http/service/mine'\n\nexport default {\n  components: {},\n  props: ['randomkey'],\n  data () {\n    return {\n      actualPrice: 0,\n      mainPicture: '',\n      mainProductName: '',\n      isPartner: false,\n      canvasSrc: '',\n      hasSubProduct: false,\n      storeLogo: '',\n      mainPictureBase64: '',\n    }\n  },\n  created () {\n    this.storeLogo = `${this.$cdnImageUrl}/${this.$util.isSyBird() ? 'new_sybird_logo' : 'zhijia'}.png`\n    this.getIdentify()\n    const shareMessage = this.$util.strJSONParse(localStorage.getItem('shareMessage'))\n    if (shareMessage) {\n      this.createQRCode(shareMessage.mdCode || '')\n      this.actualPrice = shareMessage.actualPrice\n      if (shareMessage.spuList.length) {\n        this.mainProductName = shareMessage.spuList[0].productFullName\n        this.getProductInfo(shareMessage)\n      }\n    }\n  },\n  mounted () {},\n  beforeDestroy () {},\n  methods: {\n    shareLinkFactory(mdCode) {\n      let url = `${location.origin}${location.pathname}`\n      const query = this.getCleanQuerys()\n      const mid = localStorage.getItem('mId')\n      if (mid) {\n        query.storeId = mid\n        query.shareId = mid\n      }\n      if (mdCode) {\n        query.mdCode = mdCode\n      }\n      const queryString = utils.parseParamsToQuery(query)\n      return url + queryString\n    },\n    createQRCode (mdCode) {\n      // const productId = this.$route.query.productId\n      // let url = `${config.HOST}/sgmobile/goodsDetail?productId=${productId}`\n      // const mid = localStorage.getItem('mId')\n      // if (mid) {\n      //   url += `&shareId=${mid}`\n      // }\n      // if (mdCode) {\n      //   url += `&mdCode=${mdCode}`\n      // }\n      const url = this.shareLinkFactory(mdCode)\n      this.$nextTick(() => {\n        const canvas1 = qrcanvas({\n          data: decodeURIComponent(url), // 分享链接（根据需求来）\n          size: 152 // 二维码大小\n        })\n        this.canvasSrc = canvas1.toDataURL('image/png')\n      })\n    },\n    getUrlBase64(url, ext = 'png', callback) {\n      var canvas = document.createElement('canvas'); // 创建canvas DOM元素\n      var ctx = canvas.getContext('2d');\n      var img = new Image();\n      img.crossOrigin = 'Anonymous';\n      img.src = url;\n      img.onload = function () {\n        canvas.height = 500; // 指定画板的高度,自定义\n        canvas.width = 500; // 指定画板的宽度，自定义\n        ctx.drawImage(img, 0, 0, 500, 500); // 参数可自定义\n        var dataURL = canvas.toDataURL('image/' + ext, 1);\n        callback.call(this, dataURL); // 回掉函数获取Base64编码\n        canvas = null;\n      };\n    },\n    // ajax\n    getIdentify () {\n      myManageinfo().then((res) => {\n        if (res.success) {\n          if (res.data.data.identifyFlag && [22, 21, 31].includes(res.data.data.identifyFlag)) {\n            this.isPartner = true\n          }\n        }\n      })\n    },\n    getProductInfo (shareMessage) {\n      getProductBasicInfo({\n        productId: shareMessage.spuList[0].productId,\n        channel: '',\n        openId: '',\n        sceneCode: this.$route.query.fkcode || ''\n      }).then((res) => {\n        if (res.success) {\n          this.hasSubProduct = Boolean(res.data.sgStoreAttribute[0].haschildItems)\n          if (res.data.swiperImgs && res.data.swiperImgs.length) {\n            this.mainPicture = res.data.swiperImgs[0].replace('http:', 'https:') + `?_t=${Date.now()}`\n            // this.$refs.mainPicture.onload = () => {\n            this.getUrlBase64(this.mainPicture, 'png', (base64) => {\n              this.mainPictureBase64 = base64\n            })\n            // }\n          }\n        }\n      })\n    }\n  },\n  computed: {\n    mainPictureRandom() {\n      return this.mainPicture + `&t=${this.randomkey}`\n    },\n    priceInt () {\n      return Math.floor(this.actualPrice)\n    },\n    priceFloat () {\n      const float = String(this.actualPrice.toFixed(2)).split('.')[1]\n      return float\n    }\n  },\n  watch: {}\n}\n</script>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./good-main-picture.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./good-main-picture.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./good-main-picture.vue?vue&type=template&id=31394630&\"\nimport script from \"./good-main-picture.vue?vue&type=script&lang=js&\"\nexport * from \"./good-main-picture.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}