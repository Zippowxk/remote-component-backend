(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e5c4f6f4","chunk-f8c24922"],{1797:function(e,t,a){"use strict";a("c213")},"40cb":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"upload-pic"},[e.isHaierApp?a("div",{staticClass:"photo-preview"},[e._l(e.innerImages,(function(t,n){return a("div",{key:n,staticClass:"photo-item"},[e.disabled?e._e():a("div",{staticClass:"delete-icon",on:{click:function(t){return e.doDelete(n)}}}),a("van-image",{attrs:{src:""+t.content,fit:e.imageFit},on:{click:function(t){return e.imgPreview(n)}}})],1)})),e.innerImages.length<e.maxCount&&!e.disabled?a("div",{staticClass:"photo-upload",attrs:{duration:0},on:{click:function(t){e.showActions=!0}}},[a("img",{staticClass:"camera",attrs:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAA3klEQVRYR+3ZsQ3CMBAF0PsNi8AgKZmAFZwVoCE0sIJvBSagzB7AIjSHIoVUIDk5GxH0U6WIv76eFeuUQDJdqroUkUsftw4h3HNEI0dIlxFj3AI4dvdmtqvr+pQjO1tBVd2LSNOXakIIBxYcI0DBMVrvnqUgBScK8BycCDcsoyAFUwV4UKdKfXqumGA3CZvZBsDCU9LMKgBVP7C2AFpn3gPAGap6FZGVJ6zg2tssCv72FufanmIvCQs6BTgsOAGFghRMFeA5mCr19XHLW+y1nlvslaTg3wvO4SN6kd8QT38D5VFlhkFpAAAAAElFTkSuQmCC"}}),a("div",{staticClass:"camera-des"},[e._v(e._s(e.cameraDes))])]):e._e(),a("van-action-sheet",{attrs:{actions:e.actions},on:{select:e.onSelect},model:{value:e.showActions,callback:function(t){e.showActions=t},expression:"showActions"}})],2):a("div",{staticClass:"photo-show"},[a("van-uploader",{attrs:{"before-read":e.beforeRead,accept:"image/*","max-size":e.maxSize,deletable:!e.disabled,multiple:e.multiple,"image-fit":e.imageFit,"after-read":e.uploadImg,"max-count":e.maxCount,"show-upload":!e.disabled},on:{oversize:e.onOverSize,delete:e.imagesChange},model:{value:e.innerImages,callback:function(t){e.innerImages=t},expression:"innerImages"}},[e.disabled?e._e():[a("img",{staticClass:"camera",attrs:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAA3klEQVRYR+3ZsQ3CMBAF0PsNi8AgKZmAFZwVoCE0sIJvBSagzB7AIjSHIoVUIDk5GxH0U6WIv76eFeuUQDJdqroUkUsftw4h3HNEI0dIlxFj3AI4dvdmtqvr+pQjO1tBVd2LSNOXakIIBxYcI0DBMVrvnqUgBScK8BycCDcsoyAFUwV4UKdKfXqumGA3CZvZBsDCU9LMKgBVP7C2AFpn3gPAGap6FZGVJ6zg2tssCv72FufanmIvCQs6BTgsOAGFghRMFeA5mCr19XHLW+y1nlvslaTg3wvO4SN6kd8QT38D5VFlhkFpAAAAAElFTkSuQmCC"}}),a("div",{staticClass:"camera-des"},[e._v(e._s(e.cameraDes))])]],2),e.loading?a("van-loading",{attrs:{type:"spinner",color:"#1989fa"}}):e._e()],1)])},i=[],o=(a("4662"),a("28a2")),s=(a("e7e5"),a("d399")),r=a("21b1");function c(e){return u(e)||m(e)||g(e)||l()}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function g(e,t){if(e){if("string"===typeof e)return d(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?d(e,t):void 0}}function m(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function u(e){if(Array.isArray(e))return d(e)}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var f=new r["a"],p={model:{prop:"images",event:"onImagesChange"},props:{disabled:{type:Boolean,default:!1},images:{type:Array,default:function(){return[]}},multiple:{type:Boolean,default:!1},maxSize:{type:Number,default:5242880},imageFit:{type:String,default:"cover"},oversize:{type:Function,default:function(){Object(s["a"])("图片不可大于5M")}},cameraDes:{type:String,default:"添加图片"},maxCount:{type:Number,default:6},enableImagePicker:{type:Boolean,default:!0},compressConfig:{type:Object,default:function(){return{size:{width:400,height:300},quality:.92}}}},data:function(){return{isHaierApp:this.$util.isHaierApp(),innerImages:[],loading:!1,showActions:!1,actions:[{name:"相机",callbackName:"openCamera"}]}},methods:{imgPreview:function(e){Object(o["a"])({images:this.innerImages.map((function(e){return e.content})),startPosition:e})},imagePicker:function(){var e=this;this.loading=!0,f.initDeviceReady().then((function(){console.log("sdk upload ====>"),f.upImageModule.imagePicker({max:e.maxCount-e.innerImages.length,typeMode:0,singleChoice:!1,showCamera:!1,tips:"请选择照片",cropImage:!1,showOriginalBtn:!0,allFileSizeByteLimit:e.maxSize}).then((function(t){if(console.log("success:path",t),t.retData.list.length){var a=t.retData.list.map((function(e){return e.path}));console.log("file paths",a),f.upImageModule.fileToBase64({filePaths:a}).then((function(t){console.log("result base64 arr",t.retData);var a=!1,n=t.retData.map((function(t){var n="data:image/jpeg;base64,".concat(t.base64Data),i=e.dataURLtoBlob(n),o=new window.File([i],"".concat(new Date,".jpeg"),{type:"image/jpeg"});return o.size>e.maxSize&&(a=!0),{content:n,file:o}}));a?e.onOverSize():(e.innerImages=[].concat(c(e.innerImages),c(n)),e.uploadImg()),console.log(e.innerImages,"this.innerImages")}),(function(t){console.log("base64 err",t),e.loading=!1}))}else console.log("imagePicker err"),e.loading=!1}))["catch"]((function(t){console.log("sdk imagePicker",t),e.loading=!1}))}))},openCamera:function(){var e=this;this.loading=!0,f.initDeviceReady().then((function(){f.upImageModule.openCamera({destinationType:2}).then((function(t){if(console.log("canmer result",t),t.retData.base64Data){var a=t.retData.base64Data.split(",")[0].match(/:(.*?);/)[1],n=e.dataURLtoBlob(t.retData.base64Data),i=new window.File([n],"".concat(new Date,".").concat(a.split("/")[1]),{type:a});i.size<=e.maxSize?(e.innerImages.push({content:t.retData.base64Data,file:i}),e.uploadImg()):e.onOverSize()}}),(function(t){e.loading=!1,console.log(t)}))}))},doDelete:function(e){this.innerImages.splice(e,1),this.imagesChange()},uploadImg:function(){var e=this;this.innerImages.forEach((function(t){if(console.log("前",t.file),/\/(?:jpeg|png)/i.test(t.file.type)&&t.file.size>1e6){var a=document.createElement("canvas"),n=a.getContext("2d"),i=new Image;i.src=t.content,i.onload=function(){a.width=e.compressConfig.size.width,a.height=e.compressConfig.size.height,n.drawImage(i,0,0,e.compressConfig.size.width,e.compressConfig.size.height);var o=e.dataURLtoBlob(a.toDataURL(t.file.type,e.compressConfig.quality)),s=new window.File([o],t.file.name,{type:t.file.type});t.file=s,console.log("item.file",t.file)}}})),this.imagesChange()},dataURLtoBlob:function(e){var t=e.split(","),a=t[0].match(/:(.*?);/)[1],n=atob(t[1]),i=n.length,o=new Uint8Array(i);while(i--)o[i]=n.charCodeAt(i);return new Blob([o],{type:a})},imagesChange:function(){this.loading=!1,this.$emit("onImagesChange",this.innerImages)},onSelect:function(e){this.showActions=!1,this[e.callbackName]()},onOverSize:function(){this.loading=!1,this.oversize()},beforeRead:function(e){var t=Array.isArray(e)?e:[e];return t.some((function(e){return!e.type.includes("image")}))?(this.$toast("请上传图片文件"),!1):(this.loading=!0,!0)}},watch:{enableImagePicker:{handler:function(e){e?this.actions.length<=1&&this.actions.push({name:"相册",callbackName:"imagePicker"}):this.actions.splice(1)},immediate:!0}}},h=p,A=(a("1797"),a("2877")),v=Object(A["a"])(h,n,i,!1,null,"1e6f34fa",null);t["default"]=v.exports},4662:function(e,t,a){"use strict";a("68ef"),a("a71a"),a("9d70"),a("3743"),a("09fe"),a("4d75"),a("e3b3"),a("8270"),a("786d"),a("504b")},c213:function(e,t,a){}}]);
//# sourceMappingURL=chunk-e5c4f6f4.c7f7f32f.js.map