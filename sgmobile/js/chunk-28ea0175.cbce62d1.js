(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-28ea0175"],{"54a4":function(e,t,a){"use strict";a("8e55")},"8e55":function(e,t,a){},f056:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[e.pos?a("van-nav-bar",{attrs:{title:"申请退款","right-text":"支持银行","left-arrow":""},on:{"click-left":e.onClickLeft,"click-right":e.onClickRight}},[e._t("left",(function(){return[a("i",{staticClass:"icon-back"})]}),{slot:"left"})],2):e._e(),e.pos?e._e():a("van-nav-bar",{attrs:{title:"申请退款","left-arrow":""},on:{"click-left":e.onClickLeft}},[e._t("left",(function(){return[a("i",{staticClass:"icon-back"})]}),{slot:"left"})],2),e.bankCardSelf?a("div",{staticClass:"own-not-cash"},[e._m(0)]):e._e(),e.pos?a("div",{staticClass:"other-cash"},[e._m(1)]):e._e(),a("div",{staticClass:"refund-type left-12 has-radio",staticStyle:{"margin-top":"0.24rem"}},[a("van-cell",{attrs:{"is-link":""},on:{click:function(t){return t.stopPropagation(),e.showPopupType.apply(null,arguments)}}},[a("div",{staticClass:"uni-list-cell-left"},[e._v(" 退款类型 ")]),a("div",{staticClass:"uni-list-cell-db"},[e.ifChange?a("div",{staticClass:"uni-input wait-select"},[e._v("请选择")]):e._e(),e.ifChange?e._e():a("div",{staticClass:"uni-input"},[e._v(e._s(e.array[e.index]))])])]),a("van-popup",{style:{height:"7.08rem"},attrs:{position:"bottom","close-on-click-overlay":!1},model:{value:e.showType,callback:function(t){e.showType=t},expression:"showType"}},[a("div",{staticClass:"pop-header"},[e._v(" 退款类型 "),a("div",{staticClass:"header-close",on:{click:function(t){return e.onConfirmType(e.array[e.index],e.index)}}},[a("img",{attrs:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAA5UlEQVRIS72W0Q3CIBCGf2AKHUCfCQnvzuECjuQCrmEnYAAncAoSc6YYtcBdBexLE9r+393xH1flvd/FGM8AjiGEOzpczrkNgIsx5qScc1cABwA3urdCZvEJwB7ARACipYUmSE5LUUV6QEoaT0ArpBbgC/ArhMv+A7AWwomT3gIghUjEiwAOIhWvAkqQ2RNiW2dL9N7MmWjpMTWRqGdYQCYTWhKJsyVKmVhrt1prOlIo8r6AoSXKuaXbJtes2GxTiYDknewmSz/kmjEZ5H+H3ZrIv6cqe1y3iHPzZPzIHD70R/+2PACo4e+7JpOfggAAAABJRU5ErkJggg=="}})])]),a("div",{staticClass:"pop-container"},[a("van-radio-group",{model:{value:e.index,callback:function(t){e.index=t},expression:"index"}},[a("van-cell-group",[e._l(e.array,(function(t,n){return a("van-cell",{key:n+1,attrs:{name:n,title:t,clickable:""},on:{click:function(t){e.index=n,e.ifChange=!1}},scopedSlots:e._u([{key:"right-icon",fn:function(){return[a("van-radio",{attrs:{"icon-size":"16px",name:n}})]},proxy:!0}],null,!0)})})),a("van-cell",{staticStyle:{height:"1.5rem"}})],2)],1)],1),a("div",{staticClass:"pop-bottom"},[a("div",{staticClass:"pop-bottom-btn",on:{click:function(t){return e.onConfirmType(e.array[e.index],e.index)}}},[e._v("确定")])])])],1),a("div",{staticClass:"refund-type refund-why left-12 has-radio"},[a("van-cell",{attrs:{"is-link":""},on:{click:e.showPopupWhy}},[a("div",{staticClass:"uni-list-cell-left"},[e._v(" 退款原因 ")]),a("div",{staticClass:"uni-list-cell-db"},[e.ifWhy?a("div",{staticClass:"uni-input wait-select"},[e._v("请选择")]):e._e(),e.ifWhy?e._e():a("div",{staticClass:"uni-input"},[e._v(e._s(e.reason?e.reason[e.indexWhy]:""))])])]),a("van-popup",{style:{height:"7.08rem"},attrs:{position:"bottom","close-on-click-overlay":!1},model:{value:e.showWhy,callback:function(t){e.showWhy=t},expression:"showWhy"}},[a("div",{staticClass:"pop-header"},[e._v(" 退款原因 "),a("div",{staticClass:"header-close",on:{click:function(t){return e.onConfirmWhy(e.indexWhy)}}},[a("img",{attrs:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAA5UlEQVRIS72W0Q3CIBCGf2AKHUCfCQnvzuECjuQCrmEnYAAncAoSc6YYtcBdBexLE9r+393xH1flvd/FGM8AjiGEOzpczrkNgIsx5qScc1cABwA3urdCZvEJwB7ARACipYUmSE5LUUV6QEoaT0ArpBbgC/ArhMv+A7AWwomT3gIghUjEiwAOIhWvAkqQ2RNiW2dL9N7MmWjpMTWRqGdYQCYTWhKJsyVKmVhrt1prOlIo8r6AoSXKuaXbJtes2GxTiYDknewmSz/kmjEZ5H+H3ZrIv6cqe1y3iHPzZPzIHD70R/+2PACo4e+7JpOfggAAAABJRU5ErkJggg=="}})])]),a("div",{staticClass:"pop-container"},[a("van-radio-group",{model:{value:e.indexWhy,callback:function(t){e.indexWhy=t},expression:"indexWhy"}},[a("van-cell-group",[e._l(e.reason,(function(t,n){return a("van-cell",{key:n+1,attrs:{name:n,title:t,clickable:""},on:{click:function(t){e.indexWhy=n,e.ifWhy=!1}},scopedSlots:e._u([{key:"right-icon",fn:function(){return[a("van-radio",{attrs:{"icon-size":"16px",name:n}})]},proxy:!0}],null,!0)})})),a("van-cell",{staticStyle:{height:"1.5rem"}})],2)],1)],1),a("div",{staticClass:"pop-bottom"},[a("div",{staticClass:"pop-bottom-btn",on:{click:function(t){return e.onConfirmWhy(e.indexWhy)}}},[e._v("确定")])])])],1),a("div",{staticClass:"refund-type left-12 no-border"},[a("div",{staticClass:"fefund-num"},[a("div",{staticClass:"uni-list-cell-left"},[e._v(" 退款金额 "),a("div",{staticClass:"fefund-money"},[e._v("￥"+e._s(e.toFixedTwo(e.data.orderAmount)))])])])]),e.otherFefund?a("div",{staticClass:"fefund-other"},[a("div",[e._v("其它："),e.otherFefund.usedDiamondCount?a("span",[e._v("钻石"+e._s(e.otherFefund.usedDiamondCount)+"个"),e.otherFefund.usedSeashellCount?a("span",[e._v("，")]):e._e()]):e._e(),e._v(" "),e.otherFefund.usedSeashellCount?a("span",[e._v("积分"+e._s(e.otherFefund.usedSeashellCount)+"个")]):e._e(),e.otherFefund.smartEcardAmount?a("span",[e._v(" 智家E卡"+e._s(e.otherFefund.smartEcardAmount)+"元")]):e._e(),e.otherFefund.usedSeashellCount||e.otherFefund.usedDiamondCount||e.otherFefund.smartEcardAmount?a("span",[e._v("。 ")]):e._e()])]):e._e(),e.bankCardSelf?a("div",{staticClass:"own-not-cash own-not-cash-top-margin"},[a("div",{staticClass:"bank-model"},[a("van-cell-group",[a("van-field",{attrs:{value:e.bankCardSelf,label:"银行卡号",disabled:""}})],1)],1)]):e._e(),e.pos?a("div",{staticClass:"other-cash cash-input"},[a("div",{staticClass:"refund-type no-top"},[a("van-cell-group",[a("van-field",{attrs:{label:"姓名",placeholder:"请输入姓名"},on:{blur:e.checkName},model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}}),a("van-field",{attrs:{label:"银行卡号",placeholder:"请输入借记卡号，不支持信用卡"},on:{blur:e.checkCard},model:{value:e.bankCard,callback:function(t){e.bankCard=t},expression:"bankCard"}}),a("van-field",{attrs:{label:"身份证号",placeholder:"请输入身份证号"},on:{blur:e.checkId},model:{value:e.userId,callback:function(t){e.userId=t},expression:"userId"}}),a("van-field",{attrs:{label:"预留手机号",placeholder:"请输入银行预留手机号"},on:{blur:e.checkPhone},model:{value:e.userPhone,callback:function(t){e.userPhone=t},expression:"userPhone"}})],1)],1)]):e._e(),a("div",{staticClass:"refund-des"},[a("div",{staticClass:"des-title"},[e._v(" 退款说明 ")]),a("div",{staticClass:"des-area"},[a("van-cell-group",[a("van-field",{attrs:{type:"textarea",maxlength:"500","show-word-limit":""},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}})],1)],1)]),2===e.data.orderRepairType?a("div",{staticClass:"refund-bottom"},[a("div",{staticClass:"refund-png"},[a("div",{staticClass:"png-title"},[e._v("上传凭证")]),a("upload-img",{staticStyle:{"margin-top":"12px"},attrs:{multiple:!0,maxCount:6,cameraDes:"最多6张"},model:{value:e.images,callback:function(t){e.images=t},expression:"images"}})],1)]):e._e(),a("div",{staticClass:"up"},[a("div",{staticClass:"up-btn",on:{click:e.submission}},[e._v("提交")])]),e.invoiceInvaild?a("invoice-tip-modal"):e._e()],1)},s=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tip"},[a("span",{staticStyle:{color:"#E58B49","font-size":"0.24rem"}},[e._v("请认真核对您的收款账号信息，提交后无法修改！")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tip-other"},[a("div",{staticClass:"tip-content"},[a("p",{staticStyle:{color:"#E58B49"}},[e._v("请认真核对您的收款账号信息，提交后无法修改！")]),a("p",{staticStyle:{color:"#E58B49"}},[e._v("您所填写的收款账号信息，我们将严格保密，确保不会被泄露。")])])])}],i=(a("e7e5"),a("d399")),r=a("d3c8"),o=a("2b0e"),d=function(){return a.e("chunk-44a4037a").then(a.bind(null,"8807"))},c=function(){return a.e("chunk-e5c4f6f4").then(a.bind(null,"40cb"))};o["a"].use(i["a"]);var l={components:{InvoiceTipModal:d,UploadImg:c},beforeRouteEnter:function(e,t,a){a((function(e){"orderDetail"===t.name&&(e.firstReturn=!0)}))},mounted:function(){var e=this,t={cOrderSn:null};this.$route.query.repairSn?(this.repairSn=this.$util.strJSONParse(this.$route.query.repairSn,""),t.cOrderSn=this.repairSn.cOrderSn):(this.repairSnOne=this.$route.query.cOrderSn,this.orderProductId=this.$route.query.orderProductId,console.log("orderProductId",this.orderProductId),t.cOrderSn=this.repairSnOne),r["a"].orderRepair(t).then((function(t){e.data=t.data.data,e.reasonAll=t.data.data.reason,(t.data.data.usedDiamondCount||t.data.data.usedSeashellCount||t.data.data.smartEcardAmount)&&(e.otherFefund={usedDiamondCount:t.data.data.usedDiamondCount,usedSeashellCount:t.data.data.usedSeashellCount,smartEcardAmount:t.data.data.smartEcardAmount}),t.data.data.typeActual.forEach((function(t){e.array.push(t.typeActualStr)})),e.bankCardSelf=t.data.data.bank,e.pos=t.data.data.pos})),r["a"].refundVerifyInvoice({netSn:t.cOrderSn}).then((function(t){t.data.success&&!t.data.data&&(e.invoiceInvaild=!0)}))},watch:{typeName:function(e){this.indexWhy=null,this.reasonIndex="仅退款"===e?3:"退货不退款"===e?2:1,this.reason=this.reasonAll[this.reasonIndex]}},data:function(){return{orderProductId:null,firstReturn:!1,reasonIndex:null,loading:!1,pos:!1,userPhone:"",userId:"",userName:"",bankCard:null,bankCardSelf:null,showType:!1,showWhy:!1,title:"picker",ifChange:!0,ifWhy:!0,activeIcon:"".concat(this.$cdnImageUrl,"/cart/icon-selected.png"),inactiveIcon:"".concat(this.$cdnImageUrl,"/cart/icon-unselected.png"),data:{orderRepairType:2,reason:{3:["不想要","空包裹","快递/物流一直未送达","快递无跟踪记录","破损已拒签"]},orderAmount:0,orderSn:"",typeActual:[{typeActual:3,typeActualStr:"仅退款"},{typeActual:1,typeActualStr:"退货退款"}]},array:[],reason:[],reasonAll:[],typeName:"",index:null,indexWhy:null,orderAmount:"20.05",description:"",totalNum:0,images:[],scrollTop:0,repairSn:"",repairSnOne:"",invoiceInvaild:!1,otherFefund:null}},methods:{bindPickerChange:function(e,t,a){event.stopPropagation()},onConfirmType:function(e,t){this.typeName=e,this.ifChange=!1,this.showType=!1,this.index=t,event.stopPropagation()},onCancelType:function(){this.showType=!1,event.stopPropagation()},bindPickerChangeWhy:function(e,t,a){this.indexWhy=a,event.stopPropagation()},onConfirmWhy:function(e){this.ifWhy=!1,this.showWhy=!1,this.indexWhy=e,event.stopPropagation()},onCancelWhy:function(){this.showWhy=!1,event.stopPropagation()},submission:function(){var e=this;if(this.$toast.loading({forbidClick:!0,message:"加载中...",duration:0}),this.pos){if(""===this.userName)return this.$toast("请输入姓名!"),!1;if(this.userName.length<2||this.userName>20)return this.$toast("请输入正确的姓名!"),!1;if(""===this.bankCard)return this.$toast("请输入银行卡卡号!"),!1;if(!/^\d{14,24}/.test(this.bankCard))return this.$toast("请输入正确的银行卡号!"),!1;if(""===this.userId)return this.$toast("请输入身份证号！"),!1;if(!/^\d{15}$/.test(this.userId)&&!/^\d{17}([A-z]|\d)$/.test(this.userId))return this.$toast("身份证号格式有误，请重新填写！"),!1;if(""===this.userPhone)return this.$toast("请输入预留手机号!"),!1;if(!/^1\d{10}$/.test(this.userPhone))return this.$toast("请输入正确的手机号!"),!1}if(null===this.reasonIndex)return this.$toast("请选择退款类型!"),!1;if(null===this.indexWhy)return this.$toast("请选择退款原因!"),!1;var t=this;if(t.images.length>0)this.loading=!0,r["a"].uploadPictureBybase64({base64s:t.images.map((function(e){return e.content.split(",")[1]}))}).then((function(a){if(a.data.success)if(t.pos||void 0===t.repairSn.repairSn){if(t.pos){var n={bankCard:t.bankCard,idCard:t.userId,name:t.userName,phone:t.userPhone};r["a"].bankCardValidate(n).then((function(e){if(e.data.success){var n={cOrderSn:t.repairSnOne,typeActual:t.reasonIndex,reason:t.reason[t.indexWhy],description:t.description,picUrl:a.data.data.fileList.map((function(e){return e.imgUrl})).join(),bankCard:t.bankCard,bankCode:e.data.data.bankCode,bankName:e.data.data.bankName,idCard:t.userId,name:t.userName,phone:t.userPhone};if(null===n.typeActual)return void t.$toast.fail("请选择退款类型");if(void 0===n.reason)return void t.$toast.fail("请选择退款原因");r["a"].requestOrderRepair(n).then((function(e){e.data.success?i["a"].success({message:"提交成功",duration:2e3,onClose:function(){t.$router.go(-1)}}):t.$toast(e.data.message)}))}else t.$toast(e.data.message)}))}else if(""!==t.repairSnOne&&!t.pos){var s={cOrderSn:t.repairSnOne,typeActual:t.reasonIndex,reason:t.reason[t.indexWhy],description:t.description,picUrl:a.data.data.fileList.map((function(e){return e.imgUrl})).join()};r["a"].requestOrderRepair(s).then((function(e){e.data.success?i["a"].success({message:"提交成功",duration:2e3,onClose:function(){t.$router.go(-1)}}):t.$toast(e.data.message)}))}}else{var o={repairSn:t.repairSn.repairSn,reason:t.reason[t.indexWhy],description:t.description,typeActual:t.reasonIndex,picUrl:a.data.data.fileList.map((function(e){return e.imgUrl})).join()};r["a"].modifyOrderRepair(o).then((function(e){e.data.success?(t.$toast.clear(),t.$router.replace({path:"/details",query:{orderProductId:t.repairSn.orderProductId}}),t.firstReturn||t.$router.go(-1)):t.$toast(e.data.message)}))}else e.loading=!1,t.$toast.fail(a.data.message)}))["catch"]((function(){e.loading=!1,t.$toast.fail("上传图片失败")}));else if(t.pos||void 0===t.repairSn.repairSn){if(""!==t.repairSnOne&&t.pos){var a={bankCard:t.bankCard,idCard:t.userId,name:t.userName,phone:t.userPhone};r["a"].bankCardValidate(a).then((function(e){if(e.data.success){var a={cOrderSn:t.repairSnOne,typeActual:t.reasonIndex,reason:t.reason[t.indexWhy],description:t.description,bankCard:t.bankCard,bankCode:e.data.data.bankCode,bankName:e.data.data.bankName,idCard:t.userId,name:t.userName,phone:t.userPhone};if(null===a.typeActual)return void t.$toast.fail("请选择退款类型");if(void 0===a.reason)return void t.$toast.fail("请选择退款原因");r["a"].requestOrderRepair(a).then((function(e){e.data.success?i["a"].success({message:"提交成功",duration:2e3,onClose:function(){t.$router.go(-1)}}):t.$toast(e.data.message)}))}else t.$toast(e.data.message)}))}else if(""!==t.repairSnOne&&!t.pos){var n={cOrderSn:t.repairSnOne,typeActual:t.reasonIndex,reason:t.reason[t.indexWhy],description:t.description,picUrl:""};r["a"].requestOrderRepair(n).then((function(e){e.data.success?i["a"].success({message:"提交成功",duration:2e3,onClose:function(){t.$router.go(-1)}}):t.$toast(e.data.message)}))}}else{var s={repairSn:t.repairSn.repairSn,reason:t.reason[t.indexWhy],description:t.description,typeActual:t.reasonIndex};r["a"].modifyOrderRepair(s).then((function(a){a.data.success?(e.$toast.clear(),t.$router.replace({path:"/details",query:{orderProductId:t.repairSn.orderProductId}}),t.firstReturn||t.$router.go(-1)):t.$toast(a.data.message)}))}},showPopupType:function(){this.showType=!0},showPopupWhy:function(){this.showWhy=!0},checkName:function(){""===this.userName?this.$toast("请输入姓名!"):(this.userName.length<2||this.userName>20)&&this.$toast("请输入正确的姓名!")},checkCard:function(){""===this.bankCard?this.$toast("请输入银行卡卡号!"):/^\d{14,24}/.test(this.bankCard)||this.$toast("请输入正确的银行卡号!")},checkId:function(){""===this.userId?this.$toast("请输入身份证号！"):/^\d{15}$/.test(this.userId)||/^\d{17}([A-z]|\d)$/.test(this.userId)||this.$toast("身份证号格式有误，请重新填写！")},checkPhone:function(){""===this.userPhone?this.$toast("请输入预留手机号!"):/^1\d{10}$/.test(this.userPhone)||this.$toast("请输入正确的手机号!")},onClickLeft:function(){this.$router.back()},onClickRight:function(){this.$router.push({path:"/bankslist"})},toFixedTwo:function(e){var t=Number(e).toFixed(2);return t}}},u=l,h=(a("54a4"),a("2877")),p=Object(h["a"])(u,n,s,!1,null,"1628e7c4",null);t["default"]=p.exports}}]);
//# sourceMappingURL=chunk-28ea0175.cbce62d1.js.map