{"version":3,"sources":["webpack:///./src/views/loginReg/ssoAuth.vue?50f4","webpack:///./src/views/loginReg/ssoAuth.vue?ed95","webpack:///src/views/loginReg/ssoAuth.vue","webpack:///./src/views/loginReg/ssoAuth.vue?c3fd","webpack:///./src/views/loginReg/ssoAuth.vue"],"names":["render","_vm","this","_h","$createElement","_self","_c","_m","staticRenderFns","staticClass","name","mounted","fetchAuth","query","code","redirect_uri","methods","$http","get","params","data","success","userInfo","username","result","userName","avatarImage","avatarImageFileId","loginName","birthday","phone","mobile","email","cartNumber","gender","isNewUser","isStoreMember","nickName","rankName","promotionCode","resultSign","localStorage","setItem","ucid","token","accessToken","mid","sessionKey","sessionValue","JSON","stringify","utils","ucUri","location","replace","decodeURIComponent","$router","component"],"mappings":"2IAAA,W,yCCAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAsBH,EAAII,MAAMC,GAAO,OAAOL,EAAIM,GAAG,IACnGC,EAAkB,CAAC,WAAa,IAAIP,EAAIC,KAASC,EAAGF,EAAIG,eAAmBE,EAAGL,EAAII,MAAMC,IAAIH,EAAG,OAAOG,EAAG,MAAM,CAACG,YAAY,WAAW,CAACH,EAAG,MAAM,CAACG,YAAY,UAAUH,EAAG,MAAM,CAACG,YAAY,UAAUH,EAAG,MAAM,CAACG,YAAY,UAAUH,EAAG,MAAM,CAACG,YAAY,UAAUH,EAAG,MAAM,CAACG,YAAY,c,2tBCalS,OACEC,KAAM,UACNC,QAFF,WAGI,IAAJ,oBACIT,KAAKU,UAAUC,EAAMC,KAAMD,EAAME,eAEnCC,QAAS,EAAX,KACA,gBACA,iBACA,SACA,UACA,cACA,gBACA,kBACA,cACA,cATA,IAWIJ,UAXJ,SAWA,gBACWE,EAKLZ,KAAKe,MAAMC,IAAI,EAArB,mBACQC,OAAQ,CACNL,KAAV,KAEA,+BACQ,GAAIM,EAAKC,QAAS,CAChB,IAAV,SACA,QACA,SACA,gBACA,eACA,iBACA,UACA,KACUC,EAASC,SAAWC,EAAOC,SAC3BH,EAASI,YAAcF,EAAOG,kBAC9BL,EAASM,UAAYJ,EAAOI,UAC5BN,EAASO,SAAWL,EAAOK,SAC3BP,EAASQ,MAAQN,EAAOO,OACxBT,EAASU,MAAQR,EAAOQ,MACxBV,EAASW,WAAaT,EAAOS,WAC7BX,EAASY,OAASV,EAAOU,OACzBZ,EAASa,UAAYX,EAAOW,UAC5Bb,EAASc,cAAgBZ,EAAOY,cAChCd,EAASe,SAAWb,EAAOa,SAC3Bf,EAASgB,SAAWd,EAAOc,SAC3BhB,EAASiB,cAAgBf,EAAOe,cAChCjB,EAASkB,WAAahB,EAAOgB,WAE7B,EAAV,mBACU,EAAV,UACU,EAAV,WACU,EAAV,eACU,EAAV,iBACU,EAAV,mBACU,EAAV,eACU,EAAV,YAWUC,aAAaC,QAAQ,WAAW,GAChCD,aAAaC,QAAQ,OAAQC,GAC7BF,aAAaC,QAAQ,QAASE,GAE9BH,aAAaC,QAAQ,cAAeG,GACpCJ,aAAaC,QAAQ,MAAOI,GAC5BL,aAAaC,QAAQ,aAAcK,GACnCN,aAAaC,QAAQ,eAAgBM,GACrCP,aAAaC,QAAQ,WAAYO,KAAKC,UAAU5B,IAG5C6B,EAAd,iBACgBA,EAAhB,iDACc,EAAd,uCACc,EAAd,6CAIcC,EACFC,SAASC,QAAQC,mBAAmBH,IAEpC,EAAZ,0BAGU,EAAV,6BA3EQlD,KAAKsD,QAAQF,QAAQ,cCjCmU,I,wBCQ5VG,EAAY,eACd,EACAzD,EACAQ,GACA,EACA,KACA,WACA,MAIa,aAAAiD,E","file":"js/chunk-be5d57ae.687c3927.js","sourcesContent":["export * from \"-!../../../node_modules/@sg/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ssoAuth.vue?vue&type=style&index=0&id=3fe6733a&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"spinner\"},[_c('div',{staticClass:\"rect1\"}),_c('div',{staticClass:\"rect2\"}),_c('div',{staticClass:\"rect3\"}),_c('div',{staticClass:\"rect4\"}),_c('div',{staticClass:\"rect5\"})])}]\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"spinner\">\n    <div class=\"rect1\"></div>\n    <div class=\"rect2\"></div>\n    <div class=\"rect3\"></div>\n    <div class=\"rect4\"></div>\n    <div class=\"rect5\"></div>\n  </div>\n</template>\n\n<script>\nimport URL from '@/http/url'\nimport { mapMutations } from 'vuex'\nimport utils from '@/utils/utils'\nexport default {\n  name: 'ssoAuth',\n  mounted() {\n    let query = this.$route.query;\n    this.fetchAuth(query.code, query.redirect_uri)\n  },\n  methods: {\n    ...mapMutations([\n      'setLoginStatus',\n      'setmId',\n      'setUcId',\n      'setAcsToken',\n      'setSessionKey',\n      'setSessionValue',\n      'setUserInfo',\n      'setToken'\n    ]),\n    fetchAuth(code, ucUri) {\n      if (!code) {\n        this.$router.replace('/login');\n        return\n      }\n\n      this.$http.get(URL.checkssoauth, {\n        params: {\n          code,\n        }\n      }).then(({ data }) => {\n        if (data.success) {\n          let result = data.data\n          let mid = result.mid\n          let ucid = result.ucId\n          let accessToken = result.accessToken\n          let sessionKey = result.sessionKey\n          let sessionValue = result.sessionValue\n          let token = result.token\n          let userInfo = {}\n          userInfo.username = result.userName\n          userInfo.avatarImage = result.avatarImageFileId\n          userInfo.loginName = result.loginName\n          userInfo.birthday = result.birthday\n          userInfo.phone = result.mobile\n          userInfo.email = result.email\n          userInfo.cartNumber = result.cartNumber\n          userInfo.gender = result.gender\n          userInfo.isNewUser = result.isNewUser\n          userInfo.isStoreMember = result.isStoreMember\n          userInfo.nickName = result.nickName\n          userInfo.rankName = result.rankName\n          userInfo.promotionCode = result.promotionCode\n          userInfo.resultSign = result.resultSign\n\n          this.setLoginStatus(true)\n          this.setmId(mid)\n          this.setUcId(ucid)\n          this.setAcsToken(accessToken)\n          this.setSessionKey(sessionKey)\n          this.setSessionValue(sessionValue)\n          this.setUserInfo(userInfo)\n          this.setToken(token)\n          // commit('setLoginStatus', true, { root: true });\n          // commit('setmId', mid, { root: true });\n          // commit('setUcId', ucid, { root: true });\n          // commit('setAcsToken', accessToken, { root: true })\n          // commit('setSessionKey', sessionKey, { root: true })\n          // commit('setSessionValue', sessionValue, { root: true })\n          // commit('setUserInfo', userInfo, { root: true })\n          // commit('setToken', token, { root: true });\n\n          // set locaStorage\n          localStorage.setItem('isLogin', true)\n          localStorage.setItem('ucId', ucid)\n          localStorage.setItem('token', token)\n          // localStorage.setItem('sdToken', sdToken)\n          localStorage.setItem('accessToken', accessToken)\n          localStorage.setItem('mId', mid)\n          localStorage.setItem('sessionKey', sessionKey)\n          localStorage.setItem('sessionValue', sessionValue)\n          localStorage.setItem('userInfo', JSON.stringify(userInfo))\n\n          // DSG-22686 爱创客环境中，检查路由参数，是否打开佣金展示(commissionDisplay=1 是开，0是关)；如果打开则获取身份信息保存到 store 和 sessionStorage 中\n          if (utils.isIMaker()) {\n            if (utils.parseURLQueryValue(ucUri, 'commissionDisplay')) {\n              this.$store.commit('mymanage/setSwitch', true)\n              this.$store.dispatch('mymanage/fetchManageInfo')\n            }\n          }\n\n          if (ucUri) {\n            location.replace(decodeURIComponent(ucUri));\n          } else {\n            this.$router.replace('/');\n          }\n        } else {\n          this.$router.replace('/login');\n        }\n        // this.$router.push()\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.spinner {\n  margin: .5rem auto;\n  display: flex;\n  justify-content: space-between;\n  width: .6rem;\n  height: .3rem;\n  text-align: center;\n}\n\n.spinner > div {\n  background-color: #2283E2;\n  height: 100%;\n  width: .05rem;\n  display: inline-block;\n  -webkit-animation: stretchdelay 1.2s infinite ease-in-out;\n  animation: stretchdelay 1.2s infinite ease-in-out;\n}\n\n.spinner .rect2 {\n  -webkit-animation-delay: -1.1s;\n  animation-delay: -1.1s;\n}\n\n.spinner .rect3 {\n  -webkit-animation-delay: -1.0s;\n  animation-delay: -1.0s;\n}\n\n.spinner .rect4 {\n  -webkit-animation-delay: -0.9s;\n  animation-delay: -0.9s;\n}\n\n.spinner .rect5 {\n  -webkit-animation-delay: -0.8s;\n  animation-delay: -0.8s;\n}\n\n@-webkit-keyframes stretchdelay {\n  0%, 40%, 100% { -webkit-transform: scaleY(0.4) }\n  20% { -webkit-transform: scaleY(1.0) }\n}\n\n@keyframes stretchdelay {\n  0%, 40%, 100% {\n    transform: scaleY(0.4);\n    -webkit-transform: scaleY(0.4);\n  }  20% {\n    transform: scaleY(1.0);\n    -webkit-transform: scaleY(1.0);\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ssoAuth.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ssoAuth.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ssoAuth.vue?vue&type=template&id=3fe6733a&scoped=true&\"\nimport script from \"./ssoAuth.vue?vue&type=script&lang=js&\"\nexport * from \"./ssoAuth.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ssoAuth.vue?vue&type=style&index=0&id=3fe6733a&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3fe6733a\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}