(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fdb343ce"],{"13e9":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"content"},[s("van-nav-bar",{attrs:{title:"邀请成为合伙人"},on:{"click-left":e.onClickLeft},scopedSlots:e._u([{key:"left",fn:function(){return[s("i",{staticClass:"icon-back"})]},proxy:!0}])}),e.show?s("div",{staticClass:"box"},[s("div",{staticClass:"top"},[e._v(e._s(e.storeName))]),s("div",{staticClass:"title"},[e._v("邀请您成为门店合伙人，一起开启海尔新零售！")]),s("div",{staticClass:"write"},[s("div",{staticStyle:{padding:"0.2rem 0.32rem 0.2rem 0",background:"#fff",position:"relative",height:"0.68rem"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.mobileAccount,expression:"mobileAccount"}],staticClass:"info-mm",attrs:{type:"tel",placeholder:"请输入手机号",maxlength:"13",required:""},domProps:{value:e.mobileAccount},on:{blur:e.verificationTest,keyup:e.keyup,input:function(t){t.target.composing||(e.mobileAccount=t.target.value)}}}),s("img",{staticClass:"editable-clear-x",attrs:{src:e.$cdnImageUrl+"/login/clear.png"},on:{click:e.clear}}),s("div",{staticClass:"line"})]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.captchaShow,expression:"captchaShow"}],staticStyle:{padding:"0.2rem 0.32rem 0.2rem 0",background:"#fff",position:"relative",height:"0.68rem"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.captcha,expression:"captcha"}],staticClass:"info-mm",attrs:{type:"text",placeholder:"请输入图形验证码",maxlength:"6"},domProps:{value:e.captcha},on:{blur:e.captchaStore,input:function(t){t.target.composing||(e.captcha=t.target.value)}}}),s("img",{staticClass:"verify-two",attrs:{src:e.src,alt:""},on:{click:e.getPhoto}}),s("div",{staticClass:"line"})]),s("div",{staticStyle:{padding:"0.2rem 0.32rem 0.2rem 0",background:"#fff",position:"relative",height:"0.68rem"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.messageMM,expression:"messageMM"}],staticClass:"info-mm",attrs:{type:"tel",placeholder:"请输入验证码",maxlength:"6"},domProps:{value:e.messageMM},on:{blur:e.messageStore,input:function(t){t.target.composing||(e.messageMM=t.target.value)}}}),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.messageMMType,expression:"!messageMMType"}],staticClass:"verify",style:{color:"#ccc"}},[e._v(e._s(e.title))]),s("div",{directives:[{name:"show",rawName:"v-show",value:e.messageMMType,expression:"messageMMType"}],staticClass:"verify",style:{color:e.allow?"#2979FF":"#333"},on:{click:e.getMessage}},[e._v(e._s(e.title))]),s("div",{staticClass:"line"})])]),s("div",{staticClass:"agree"},[s("van-checkbox",{attrs:{"icon-size":"0.3rem"},on:{change:e.selectChange},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}}),e._m(0)],1),s("button",{staticClass:"btn",style:{background:e.disabled?"#ccc":"#2979FF"},attrs:{disabled:e.disabled},on:{click:e.submit}},[e._v("提交")])]):s("success",{attrs:{storeName:e.storeName,storeId:e.storeId}})],1)},o=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"right"},[s("span",[e._v("若为新用户提交即代表同意")]),s("a",{attrs:{href:"http://m.ehaier.com/v3/mstore/sg/helpDetail.html?id=1002",target:"blank"}},[e._v("《智家掌柜用户服务协议》、")]),s("a",{attrs:{href:"http://m.ehaier.com/v3/mstore/sg/helpDetail.html?id=1206",target:"blank"}},[e._v("《智家掌柜隐私权政策》、")]),s("a",{attrs:{href:"http://account.haier.com/html/privacypolicy.html",target:"blank"}},[e._v("《海尔家电隐私权政策》")])])}],i=s("aa19"),r=s("4313"),c=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"success-box"},[s("div",{staticClass:"top"},[s("img",{attrs:{src:e.$cdnImageUrl+"/login/success.png",alt:""}})]),s("div",{staticClass:"content-two"},[e._v("恭喜您成为"),s("span",[e._v(e._s(e.storeName))]),e._v("的合伙人")]),s("div",{staticClass:"operate"},[s("div",{staticClass:"btn",on:{click:e.toStore}},[e._v("立即访问店铺")])])])},n=[],l={props:["storeName","storeId"],methods:{toStore:function(){this.$router.replace("/shopDetail?storeId=".concat(this.storeId))}}},m=l,h=(s("ed4b"),s("2877")),u=Object(h["a"])(m,c,n,!1,null,null,null),d=u.exports,g={data:function(){return{storeName:"店铺名称",title:"获取验证码",checked:!1,mobileAccount:"",messageMM:"",allow:!0,phoneReg:/^1[3456789]\d{9}$/,captchaShow:!1,captcha:"",src:"",messageMMType:!1,disabled:!0,timer:null,shareId:null,storeId:null,show:!0,getClick:!1}},components:{success:d},created:function(){this.$util.smMsgSdk(),this.location(),this.initialize(),this.androidBack()},watch:{messageMM:function(e,t){6!==e.length?this.disabled=!0:this.disabled=!1}},methods:{androidBack:function(){sessionStorage.getItem("invitePhone")&&(this.mobileAccount=sessionStorage.getItem("invitePhone")),13===this.mobileAccount.length?this.messageMMType=!0:this.messageMMType=!1,sessionStorage.getItem("inviteCaptcha")&&(this.captcha=sessionStorage.getItem("inviteCaptcha")),sessionStorage.getItem("inviteMessage")&&(this.messageMM=sessionStorage.getItem("inviteMessage")),"true"===sessionStorage.getItem("captchaShow")&&(this.captchaShow=!0),sessionStorage.getItem("checked")&&(this.checked=sessionStorage.getItem("checked")),"true"===sessionStorage.getItem("getClick")&&(this.getClick=!0),"false"===sessionStorage.getItem("inviteAllow")&&(this.allow=!1),this.getPhoto()},keyup:function(){var e=this.mobileAccount;e=e.replace(/[^0-9]/g,"");var t=[];t[0]=e.slice(0,3),t[1]=e.slice(3,7),t[2]=e.slice(7),t[2].length>0?(t[1]+=" ",t[0]+=" "):t[1].length>0&&(t[0]+=" "),13===this.mobileAccount.length?(this.messageMMType=!0,this.verification()):this.messageMMType=!1,this.mobileAccount=t.join("")},verification:function(){var e=this,t=this.mobileAccount.replace(/\s/g,"");if(this.phoneReg.test(t)){var s={mobile:t};i["a"].needImg(s).then((function(t){t.data.data?(e.captchaShow=!0,e.getPhoto()):e.captchaShow=!1,sessionStorage.setItem("captchaShow",e.captchaShow)}))}else this.$toast("手机号格式不正确，请重新输入")},verificationTest:function(){var e=this.mobileAccount.replace(/\s/g,"");this.phoneReg.test(e)?sessionStorage.setItem("invitePhone",this.mobileAccount):this.$toast("手机号格式不正确，请重新输入")},captchaStore:function(){sessionStorage.setItem("inviteCaptcha",this.captcha)},messageStore:function(){sessionStorage.setItem("inviteMessage",this.messageMM)},clear:function(){this.mobileAccount=""},selectChange:function(e){console.log(666,e),this.checked=e,sessionStorage.setItem("checked",this.checked)},getPhoto:function(){this.src=this.$HOST+"/v3/platform/web/member/register/getImgCaptcha.html?rnd="+Math.random()+"&flag="+localStorage.getItem("sessionValue")},getMessage:function(){var e=this,t=this.mobileAccount.replace(/\s/g,"");this.$util.dealSmDeviceId().then((function(s){var a={mobile:t};e.captchaShow&&(a.imgCaptcha=e.captcha),e.captchaShow&&""===e.captcha?e.$toast("请输入图片验证码"):e.phoneReg.test(t)&&e.allow&&i["a"].register(a,s).then((function(t){if(!1===t.data.success)e.$toast(t.data.message);else{e.allow=!1,sessionStorage.setItem("inviteAllow",!0),e.$toast("短信验证码发送成功，请及时验证！"),e.getClick=!0,sessionStorage.setItem("getClick",!0);var s=60;e.timer=setInterval((function(){0===s?(e.allow=!0,clearInterval(e.timer),e.title="重新获取验证码"):(e.title=s+"s后可重发",e.allow=!1,s--)}),1e3)}}))}))},submit:function(){var e=this,t=this.$store.state.locationInfo;if(console.log("------------定位信息",t),this.checked){var s=this.mobileAccount.replace(/\s/g,"");if(this.phoneReg.test(s))if(""!==this.messageMM)if(this.getClick){var a={captcha:this.messageMM,memberNumber:s,shareId:Number(this.shareId),storeId:Number(this.storeId),provinceId:Number(t.provinceId),cityId:Number(t.cityId),regionId:Number(t.districtId),regionName:t.region.replace(/\s/g,"")};r["a"].acceptInvite(a).then((function(t){if(t.data.success){var s=t.data.data,a=s.mid,o=s.accessToken,i={};i.username=s.userName,i.avatarImage=s.avatarImageFileId,i.loginName=s.loginName,i.birthday=s.birthday,i.phone=s.mobile,i.email=s.email,i.cartNumber=s.cartNumber,i.gender=s.gender,i.isNewUser=s.isNewUser,i.isStoreMember=s.isStoreMember,i.nickName=s.nickName,i.rankName=s.rankName,i.promotionCode=s.promotionCode,i.resultSign=s.resultSign,e.$store.commit("setLoginStatus",!0,{root:!0}),e.$store.commit("setmId",s.mid,{root:!0}),e.$store.commit("setUcId",s.ucId,{root:!0}),e.$store.commit("setAcsToken",s.accessToken,{root:!0}),e.$store.commit("setSessionKey",s.sessionKey,{root:!0}),e.$store.commit("setSessionValue",s.sessionValue,{root:!0}),e.$store.commit("setUserInfo",i,{root:!0}),e.$store.commit("setToken",s.token,{root:!0}),localStorage.setItem("isLogin",!0),localStorage.setItem("ucId",s.ucId),localStorage.setItem("token",s.token),localStorage.setItem("accessToken",s.accessToken),localStorage.setItem("mId",s.mid),localStorage.setItem("sessionKey",s.sessionKey),localStorage.setItem("sessionValue",s.sessionValue),localStorage.setItem("userInfo",JSON.stringify(i)),e.$store.dispatch("account/isHasStore",{mid:a,accessToken:o}),t.data.errorCode||(e.show=!1)}else e.$toast(t.data.message);t.data.errorCode&&e.$toast(t.data.message)}))}else this.$toast("请先获取验证码");else this.$toast("请输入短信验证码");else this.$toast("手机号格式不正确，请重新输入")}else this.$toast("请您认真阅读平台相关协议，然后签收。")},open:function(){var e=this,t={shareId:this.shareId,storeId:this.storeId};r["a"].openShareLink(t).then((function(t){t.data.success?(e.storeName=t.data.data.storeName,e.storeId=t.data.data.storeId):e.$toast(t.data.message)}))},initialize:function(){this.$route.query.store&&this.$route.query.share&&(this.storeId=this.$route.query.store,this.shareId=this.$route.query.share,this.open())},location:function(){var e=this;this.$store.dispatch("doLocation").then((function(t){400===t?e.$store.dispatch("doLocationInfo",{latitude:"36.12784",longitude:"120.41803"}):e.$store.dispatch("doLocationInfo",t)}))},onClickLeft:function(){this.$router.push("/")}}},p=g,v=(s("fa0d"),Object(h["a"])(p,a,o,!1,null,"7c59a070",null));t["default"]=v.exports},4313:function(e,t,s){"use strict";var a=s("1c03"),o=s("bbc2"),i=s("fa7d"),r=function(e){return a["a"].request({url:o["a"].openShareLink,method:"get",params:e})},c=function(e){return a["a"].request({url:o["a"].acceptInvite,method:"post",data:e})},n=function(e){return a["a"].request({url:"".concat(o["a"].openInvitation).concat(i["a"].parseParamsToQuery(e)),method:"post",data:e})},l=function(e){return a["a"].request({url:"".concat(o["a"].acceptInvitationAdd).concat(i["a"].parseParamsToQuery(e)),method:"post",data:e})};t["a"]={openShareLink:r,acceptInvite:c,openInvitation:n,acceptInvitationAdd:l}},4750:function(e,t,s){},"48d6":function(e,t,s){},aa19:function(e,t,s){"use strict";var a=s("1c03"),o=s("bbc2"),i=function(e,t){return a["a"].request({url:o["a"].register,headers:{deviceId:t+"",Authorization:"open the gate"},method:"GET",params:e})},r=function(e,t){return a["a"].request({url:o["a"].login,method:"POST",params:e})},c=function(e){return a["a"].request({url:o["a"].password,method:"GET",params:e})},n=function(e){return a["a"].request({url:o["a"].needImg,method:"GET",params:e})},l=function(e){return a["a"].request({url:o["a"].getImg,method:"GET",params:e})},m=function(e){return a["a"].request({url:o["a"].retrieve,method:"GET",params:e})},h=function(e){return a["a"].request({url:o["a"].changePassword,method:"POST",params:e})},u=function(e,t){return a["a"].request({url:o["a"].registerAccount,method:"POST",params:e})};t["a"]={register:i,login:r,password:c,needImg:n,getImg:l,retrieve:m,changePassword:h,registerAccount:u}},ed4b:function(e,t,s){"use strict";s("48d6")},fa0d:function(e,t,s){"use strict";s("4750")}}]);
//# sourceMappingURL=chunk-fdb343ce.af5f959e.js.map