(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-256b745f"],{"347c":function(t,i,e){},4662:function(t,i,e){"use strict";e("68ef"),e("a71a"),e("9d70"),e("3743"),e("09fe"),e("4d75"),e("e3b3"),e("8270"),e("786d"),e("504b")},"4fe3":function(t,i,e){"use strict";e.r(i);var s=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"top-container"},[e("Header"),t.skeletonLoading?e("skeleton",{attrs:{nums:3}}):e("van-pull-refresh",{on:{refresh:t.onRefresh},scopedSlots:t._u([{key:"pulling",fn:function(){return[e("refreshLoading",{attrs:{text:"下拉刷新"}})]},proxy:!0},{key:"loosing",fn:function(){return[e("refreshLoading",{attrs:{text:"下拉刷新"}})]},proxy:!0},{key:"loading",fn:function(){return[e("refreshLoading",{attrs:{text:"加载中"}})]},proxy:!0},{key:"success",fn:function(){return[e("refreshLoading",{attrs:{text:"加载完成"}})]},proxy:!0}]),model:{value:t.isLoading,callback:function(i){t.isLoading=i},expression:"isLoading"}},[t.listLeft.length>0?e("van-list",{attrs:{finished:t.finished,finishedText:"全部数据加载完成","van-clearfix":"","immediate-check":!1},on:{load:t.onLoad},model:{value:t.loading,callback:function(i){t.loading=i},expression:"loading"}},[e("div",{staticClass:"container"},[e("div",{staticClass:"left"},t._l(t.listLeft,(function(i,s){return e("div",{key:s,staticClass:"comment-item",on:{click:function(e){return t.fnPreviewImage(i,s)}}},[e("div",{staticClass:"thumb"},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.imageToHttps(i.picList[0].picUrl),expression:"imageToHttps(item.picList[0].picUrl)"}],attrs:{alt:""}}),e("span",{staticClass:"pic-number"},[t._v(" "+t._s(i.picList.length)+" "),e("span",{staticClass:"pic-logo"})])]),e("div",{staticClass:"content"},[t._v(t._s(i.commentContent))]),e("div",{staticClass:"info"},[e("span",{staticClass:"logo"}),e("span",{staticClass:"text"},[t._v(t._s(i.memberName))])])])})),0),e("div",{staticClass:"right"},t._l(t.listRight,(function(i,s){return e("div",{key:s,staticClass:"comment-item",on:{click:function(e){return t.fnPreviewImage(i,s)}}},[e("div",{staticClass:"thumb"},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.imageToHttps(i.picList[0].picUrl),expression:"imageToHttps(item.picList[0].picUrl)"}],attrs:{alt:""}}),e("span",{staticClass:"pic-number"},[t._v(" "+t._s(i.picList.length)+" "),e("span",{staticClass:"pic-logo"})])]),e("div",{staticClass:"content"},[t._v(t._s(i.commentContent))]),e("div",{staticClass:"info"},[e("span",{staticClass:"logo"}),e("span",{staticClass:"text"},[t._v(t._s(i.memberName))])])])})),0)])]):t._e()],1),e("van-image-preview",{ref:"pre",staticStyle:{background:"#000"},attrs:{"start-position":t.picStartIndex,images:t.imgPreShowList,loop:!1,"show-index":!1,"get-container":"#app-warp"},on:{change:t.onChange,close:t.preClose},scopedSlots:t._u([{key:"cover",fn:function(){return[e("div",{staticClass:"pic-pre-idx"},[e("span",[t._v(t._s(t.imgPreShowIndex+1)+"/"+t._s(t.imgPreShowList.length))])]),e("div",{staticClass:"comment-text",class:{fold:!t.expandStatus}},[e("div",{staticClass:"text-left"},[t._v(t._s(t.commentPreList[t.imgPreShowIndex].comment))]),e("div",{staticClass:"text-right",on:{click:t.toggleExpand}},[t.expandStatus?e("div",{staticClass:"open"}):e("div",{staticClass:"close"})])]),e("div",{staticClass:"img-pre-back",on:{click:t.preClose}})]},proxy:!0}]),model:{value:t.imgPreShow,callback:function(i){t.imgPreShow=i},expression:"imgPreShow"}})],1)},n=[],a=(e("4662"),e("28a2")),o=(e("66cf"),e("343b")),c=e("2b0e"),r=e("e725"),l=e("a73f"),m=e("85e4"),p=function(){return e.e("chunk-079cb250").then(e.bind(null,"d7a6"))};c["a"].use(o["a"]),c["a"].use(a["a"]);var d={components:{skeleton:l["a"],refreshLoading:p,Header:r["a"]},data:function(){return{expandFlag:!1,list:[],listLeft:[],listRight:[],imgTotalCount:0,productId:0,lastIndex:0,skeletonLoading:!0,loading:!1,finished:!1,isLoading:!1,imgPreShow:!1,imgPreShowList:[],imgPreShowIndex:0,commentContent:"",commentTextShowStatus:!1,expandStatus:!1,picStartIndex:0,commentPreList:[],commentOld:"",pageParam:{pageNum:1,pageSize:10}}},created:function(){var t=this;this.productId=this.$route.query.productId,this.toAssessList().then((function(i){t.onRefresh()}))},methods:{fnExpandNavigation:function(){this.expandFlag=!this.expandFlag},preClose:function(){this.imgPreShow=!1,this.expandStatus=!1},toggleExpand:function(){this.expandStatus=!this.expandStatus},onChange:function(t){this.imgPreShowIndex=t,t!==this.imgPreShowList.length-2||this.finished||(this.picStartIndex=t,this.onLoad()),this.commentPreList[t].id!==this.commentOld&&(this.expandStatus=!1),this.commentOld=this.commentPreList[t].id},fnPreviewImage:function(t,i){var e=this;this.imgPreShowList.forEach((function(i,s){(t.commentPics[0]&&t.commentPics[0].picUrl===i||t.experiencePics[0]&&t.experiencePics[0].picUrl===i)&&(e.picStartIndex=s,e.commentOld=e.commentPreList[e.picStartIndex].id)})),this.imgPreShow=!1,this.imgPreShow=!0,this.commentContent=t.commentContent},toAssessList:function(){var t=this;return new Promise((function(i,e){Object(m["Pb"])({productId:t.productId}).then((function(e){e.success&&(t.imgTotalCount=e.data.hasPicNum),i()}))}))},onRefresh:function(){this.pageParam.pageNum=1,this.loading=!1,this.finished=!0,this.isLoading=!0,this.initData()},onLoad:function(){this.pageParam.pageNum+=1,this.initData()},initData:function(){var t=this;return new Promise((function(i,e){1===t.pageParam.pageNum&&(t.imgPreShowList=[],t.commentPreList=[]);var s={commentType:"image",productId:t.productId,pageSize:t.pageParam.pageSize,pageIndex:t.pageParam.pageNum};Object(m["I"])(s).then((function(e){e.success&&(t.imgCommentList=e.data,t.imgCommentList.forEach((function(t){t.picList=t.commentPics.concat(t.experiencePics)})),t.skeletonLoading=!1,t.calcShowList(t.imgCommentList),t.finished=!1,t.loading=!1,t.isLoading&&(t.isLoading=!1),t.listLeft.length+t.listRight.length>=t.imgTotalCount&&(t.finished=!0),i())}))}))},imageToHttps:function(t){if(t)return t.indexOf("http:")>=0&&(t=t.replace("http:","https:")),t},calcShowList:function(t){var i=this,e=[],s=[];t.forEach((function(t,n){var a=[],o=[];t.commentPics.forEach((function(i){a.push(i.picUrl),o.push({comment:t.commentContent,id:t.commentId})})),t.experiencePics.forEach((function(i){a.push(i.picUrl),o.push({comment:t.commentContent,id:t.commentId})})),i.imgPreShowList=i.imgPreShowList.concat(a),i.commentPreList=i.commentPreList.concat(o),n%2===0?e.push(t):s.push(t)})),1===this.pageParam.pageNum?(this.listLeft=e,this.listRight=s):(this.listLeft=this.listLeft.concat(e),this.listRight=this.listRight.concat(s))}}},h=d,u=(e("95b7"),e("2877")),g=Object(u["a"])(h,s,n,!1,null,"4d431e80",null);i["default"]=g.exports},"80cc":function(t,i,e){"use strict";e("347c")},"95b7":function(t,i,e){"use strict";e("c53e")},a73f:function(t,i,e){"use strict";var s=function(t,i){var e=i._c;return i.props.nums>0?e("div",{staticClass:"m-skeleton",style:{"z-index":i.props.zIndex||0}},[e("div",{style:{background:i.props.bgColor,height:i.props.fheight}}),i._l(i.props.nums-1,(function(t){return e("div",{key:t,style:{background:i.props.bgColor,height:i.props.iheight}})}))],2):i._e()},n=[],a=(e("80cc"),e("2877")),o={},c=Object(a["a"])(o,s,n,!0,null,null,null);i["a"]=c.exports},c53e:function(t,i,e){}}]);
//# sourceMappingURL=chunk-256b745f.48c402b3.js.map